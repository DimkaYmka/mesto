(()=>{"use strict";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,r(o.key),o)}}function n(e,t,n){return(t=r(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(t){var n=function(t,n){if("object"!==e(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,"string");if("object"!==e(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===e(n)?n:String(n)}var o={selectorList:".elements__card",selectorTemplate:"#card",cardImgSelector:".elements__image",cardTitleSelector:".elements__title",cardDeleteBtnSelector:".elements__delete-button",toggleLikeSelector:".elements__vector",activeLikeBtnClass:"elements__vector_active",countLikes:".elements__likes-number"},i=function(){function e(t,r,o,i,u,c){var a=this,l=u.handleLikeCard,s=c.handleDeleteCard;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),n(this,"_deleteCardForSure",(function(){a._handleDeleteCard(a._cardData,a)})),n(this,"_getCardLike",(function(){a._likes.some((function(e){return e._id===a._userId}))?(a._likeButton.classList.add("elements__vector_active"),a.isLiked=!0):a._likeButton.classList.remove("elements__vector_active")})),n(this,"getLikesNumber",(function(e){a._likeNumber.innerHTML=e})),n(this,"likeCard",(function(){a._likeButton.classList.toggle("elements__vector_active")})),n(this,"_setDeleteButton",(function(){a._cardOwner===a._userId&&a._deleteButton.classList.remove("elements__delete-button_hidden")})),this._cardData=t,this._name=t.name,this._link=t.link,this._config=r,this._handleCardClick=o,this._userId=i,this._handleLikeCard=l,this._likes=t.likes,this._handleDeleteCard=s,this._cardOwner=t.owner._id}var r,o;return r=e,(o=[{key:"_getTemplate",value:function(){return document.querySelector(this._config.selectorTemplate).content.querySelector(".elements__card").cloneNode(!0)}},{key:"deleteCard",value:function(){this._element.remove()}},{key:"_toggleLike",value:function(e){e.classList.toggle(this._config.activeLikeBtnClass)}},{key:"_setEventListeners",value:function(){var e=this,t=this._element.querySelector(this._config.cardDeleteBtnSelector),n=this._element.querySelector(this._config.toggleLikeSelector);t.addEventListener("click",(function(){e._deleteCardForSure()})),this._cardImage.addEventListener("click",(function(){e._handleCardClick(e._name,e._link)})),n.addEventListener("click",(function(){e._handleLikeCard(e._cardData)}))}},{key:"createNewCard",value:function(){return this._element=this._getTemplate(),this._cardImage=this._element.querySelector(this._config.cardImgSelector),this._cardImage.src=this._link,this._cardImage.alt=" ".concat(this._link,"."),this._element.querySelector(this._config.cardTitleSelector).textContent=this._name,this._likeButton=this._element.querySelector(this._config.toggleLikeSelector),this._likeNumber=this._element.querySelector(this._config.countLikes),this._likes=this._cardData.likes,this._likeNumber.innerHTML=this._likes.length,this.isLiked=!1,this._deleteButton=this._element.querySelector(this._config.cardDeleteBtnSelector),this._setDeleteButton(),this._setEventListeners(),this._getCardLike(),this.getLikesNumber(this._likes.length),this._element}}])&&t(r.prototype,o),Object.defineProperty(r,"prototype",{writable:!1}),e}();function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==u(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==u(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===u(o)?o:String(o)),r)}var o}var a={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__save-btn",inactiveButtonClass:"popup__save-btn_inactive",inputErrorClass:"popup__input_type_error",errorClass:"popup__input-error_active"},l=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._formSetting=t,this._formElement=n,this._inputList=Array.from(this._formElement.querySelectorAll(this._formSetting.inputSelector)),this._submitButton=this._formElement.querySelector(this._formSetting.submitButtonSelector)}var t,n;return t=e,(n=[{key:"_showInputError",value:function(e,t){var n=this._formElement.querySelector(".".concat(e.id,"-error"));e.classList.add(this._formSetting.inputErrorClass),n.textContent=t,n.classList.add(this._formSetting.errorClass)}},{key:"_hideInputError",value:function(e){var t=this._formElement.querySelector(".".concat(e.id,"-error"));t.textContent="",e.classList.remove(this._formSetting.inputErrorClass),t.classList.remove(this._formSetting.errorClass)}},{key:"_checkInputValidity",value:function(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}},{key:"resetValidation",value:function(){var e=this;this._toggleButtonState(),this._inputList.forEach((function(t){e._hideInputError(t)}))}},{key:"_toggleButtonState",value:function(){this._hasInvalidInput()?(this._submitButton.classList.add(this._formSetting.inactiveButtonClass),this._submitButton.disabled=!0):(this._submitButton.classList.remove(this._formSetting.inactiveButtonClass),this._submitButton.disabled=!1)}},{key:"_hasInvalidInput",value:function(){return this._inputList.some((function(e){return!e.validity.valid}))}},{key:"_setEventListeners",value:function(){var e=this;this._toggleButtonState(),this._inputList.forEach((function(t){t.addEventListener("input",(function(){e._checkInputValidity(t),e._toggleButtonState()}))}))}},{key:"enableValidation",value:function(){this._formElement.addEventListener("submit",(function(e){e.preventDefault()})),this._setEventListeners()}}])&&c(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==s(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==s(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===s(o)?o:String(o)),r)}var o}var p=function(){function e(t,n){var r=t.items,o=t.renderer;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._renderItems=r,this._renderer=o,this._container=document.querySelector(n)}var t,n;return t=e,(n=[{key:"renderItems",value:function(e){var t=this;e.forEach((function(e){return t._renderer(e)}))}},{key:"addItem",value:function(e){this._container.prepend(e)}}])&&f(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function y(e){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},y(e)}function h(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==y(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==y(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===y(o)?o:String(o)),r)}var o}var d=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._popup=document.querySelector(t),this._handleEscClose=this._handleEscClose.bind(this)}var t,n;return t=e,(n=[{key:"open",value:function(){this._popup.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEscClose)}},{key:"close",value:function(){this._popup.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClose)}},{key:"_handleEscClose",value:function(e){"Escape"===e.key&&this.close()}},{key:"setEventListeners",value:function(){var e=this;this._popup.addEventListener("mousedown",(function(t){t.target.classList.contains("popup_opened")&&e.close(),t.target.classList.contains("popup__close-popup")&&e.close()}))}}])&&h(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function m(e){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},m(e)}function _(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==m(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==m(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===m(o)?o:String(o)),r)}var o}function v(){return v="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=g(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},v.apply(this,arguments)}function b(e,t){return b=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},b(e,t)}function g(e){return g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},g(e)}var S=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&b(e,t)}(u,e);var t,n,r,o,i=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=g(r);if(o){var n=g(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===m(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function u(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(t=i.call(this,e))._popupBigImage=t._popup.querySelector(".popup__big-image"),t._popupTitle=t._popup.querySelector(".popup__big-title"),t}return t=u,(n=[{key:"open",value:function(e,t){v(g(u.prototype),"open",this).call(this),this._popupBigImage.src=t,this._popupBigImage.alt=e,this._popupTitle.textContent=e}}])&&_(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),u}(d);function k(e){return k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},k(e)}function w(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,C(r.key),r)}}function E(e,t){return E=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},E(e,t)}function L(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function O(){return O="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=P(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},O.apply(this,arguments)}function P(e){return P=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},P(e)}function j(e,t,n){return(t=C(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function C(e){var t=function(e,t){if("object"!==k(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==k(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===k(t)?t:String(t)}var T=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&E(e,t)}(u,e);var t,n,r,o,i=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=P(r);if(o){var n=P(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===k(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return L(e)}(this,e)});function u(e,t,n){var r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),j(L(o=i.call(this,e)),"_getInputValues",(function(){var e={};return o._inputList.forEach((function(t){e[t.name]=t.value})),e})),j(L(o),"setEventListeners",(function(){O((r=L(o),P(u.prototype)),"setEventListeners",r).call(r),o._form.addEventListener("submit",(function(e){e.preventDefault(),o._handleProfileFormSubmit(o._getInputValues(),o._btnForm),o.close()}))})),o._handleProfileFormSubmit=t,o._form=o._popup.querySelector(".popup__form"),o._inputList=o._form.querySelectorAll(".popup__input"),o._btnForm=o._form.querySelector(n),o}return t=u,(n=[{key:"getInputValues",value:function(){return this._inputFormValues}},{key:"close",value:function(){O(P(u.prototype),"close",this).call(this),this._form.reset()}}])&&w(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),u}(d);function I(e){return I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},I(e)}function B(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==I(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==I(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===I(o)?o:String(o)),r)}var o}var q=function(){function e(t){var n=t.profileNameSelector,r=t.profileInfoSelector,o=t.avatarSelector;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._name=document.querySelector(n),this._info=document.querySelector(r),this._userAvatar=document.querySelector(o)}var t,n;return t=e,(n=[{key:"getUserInfo",value:function(){return{name:this._name.textContent,info:this._info.textContent}}},{key:"setUserInfo",value:function(e){this._name.textContent=e.name,this._info.textContent=e.about}},{key:"setUserAvatar",value:function(e){var t=e.link;this._userAvatar.src=t}}])&&B(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function R(e){return R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},R(e)}function D(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==R(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==R(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===R(o)?o:String(o)),r)}var o}var U=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._baseUrl=t.baseUrl,this._headers=t.headers}var t,n;return t=e,(n=[{key:"_getResponse",value:function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}},{key:"getInitialCards",value:function(){return fetch("".concat(this._baseUrl,"/cards"),{method:"GET",headers:this._headers}).then(this._getResponse)}},{key:"getUserData",value:function(){return fetch("".concat(this._baseUrl,"/users/me"),{method:"GET",headers:this._headers}).then(this._getResponse)}},{key:"editUserData",value:function(e){return fetch("".concat(this._baseUrl,"/users/me"),{method:"PATCH",headers:this._headers,body:JSON.stringify(e)}).then(this._getResponse)}},{key:"createCard",value:function(e){return fetch("".concat(this._baseUrl,"/cards"),{method:"POST",headers:this._headers,body:JSON.stringify(e)}).then(this._getResponse)}},{key:"addLike",value:function(e){return fetch("".concat(this._baseUrl,"/cards/").concat(e._id,"/likes"),{method:"PUT",headers:this._headers,body:JSON.stringify(e)}).then(this._getResponse)}},{key:"deleteLike",value:function(e){return fetch("".concat(this._baseUrl,"/cards/").concat(e,"/likes"),{method:"DELETE",headers:this._headers}).then(this._getResponse)}},{key:"editUserAvatar",value:function(e){return fetch("".concat(this._baseUrl,"/users/me/avatar"),{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})}).then(this._getResponse)}},{key:"deleteCard",value:function(e){return fetch("".concat(this._baseUrl,"/cards/").concat(e),{method:"DELETE",headers:this._headers}).then(this._getResponse)}}])&&D(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function x(e){return x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},x(e)}function N(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,J(r.key),r)}}function V(e,t){return V=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},V(e,t)}function A(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function F(){return F="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=H(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},F.apply(this,arguments)}function H(e){return H=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},H(e)}function J(e){var t=function(e,t){if("object"!==x(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==x(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===x(t)?t:String(t)}var M=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&V(e,t)}(u,e);var t,n,r,o,i=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=H(r);if(o){var n=H(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===x(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return A(e)}(this,e)});function u(e){var t,n,r,o,c;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),r=A(n=i.call(this,e)),c=function(){F((t=A(n),H(u.prototype)),"setEventListeners",t).call(t),n._form.addEventListener("submit",(function(e){e.preventDefault(),n._handleProfileFormSubmit(),n.close()}))},(o=J(o="setEventListeners"))in r?Object.defineProperty(r,o,{value:c,enumerable:!0,configurable:!0,writable:!0}):r[o]=c,n._form=n._popup.querySelector(".popup__form"),n._submitButton=n._popup.querySelector(".popup__save-btn"),n}return t=u,(n=[{key:"handleDeleteConfirm",value:function(e){var t=e.handleProfileFormSubmit;this._handleProfileFormSubmit=t}}])&&N(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),u}(d),G=document.querySelector(".profile__edit-button"),z=document.querySelector("#input-name"),K=document.querySelector("#input-info"),Q=document.querySelector(".profile__add-button"),W=(document.querySelector(".popup__big-image"),document.querySelector(".popup__big-title"),document.querySelector(".popup_image"),document.querySelector(".popup__form-profile")),X=document.querySelector(".popup__form-card"),Y=document.querySelector(".popup__form-avatar"),Z=".popup__save-btn",$="Сохранение...",ee=new l(a,W);ee.enableValidation();var te=new l(a,X);te.enableValidation();var ne=new l(a,Y);ne.enableValidation();var re,oe=new U({baseUrl:"https://mesto.nomoreparties.co/v1/cohort-62",headers:{authorization:"bc440bce-88d2-40de-813f-9186a5211a71","Content-Type":"application/json"}}),ie=new q({profileNameSelector:".profile__name",profileInfoSelector:".profile__text",avatarSelector:".profile__avatar"}),ue=new S(".popup_image"),ce=new M(".popup_delete"),ae=new p({renderer:function(e){var t=fe(e).createNewCard();ae.addItem(t)}},".elements__list");oe.getUserData().then((function(e){ie.setUserInfo({name:e.name,about:e.about}),ie.setUserAvatar({link:e.avatar}),re=e._id,oe.getInitialCards().then((function(e){ae.renderItems(e)})).catch((function(e){console.log(e)}))})).catch((function(e){return alert(e)}));var le=new T(".popup_profile",(function(e,t){var n=t.textContent;ye(t,$),oe.editUserData(e).then((function(e){ie.setUserInfo(e)})).then((function(){le.close()})).catch((function(t){alert(t),ie.setUserInfo(e)})).finally((function(){ye(t,n)}))}),Z);G.addEventListener("click",(function(){var e=ie.getUserInfo();z.value=e.name,K.value=e.info,ee.resetValidation(),le.open()}));var se=new T(".popup_card",(function(e,t){var n=t.textContent;ye(t,$),oe.createCard(e).then((function(e){fe(e),ae.addItem(fe(e).createNewCard()),se.close()})).catch((function(e){return alert(e)})).finally((function(){ye(t,n)}))}),Z);function fe(e){var t=new i(e,o,he,re,{handleLikeCard:function(e){t.isLiked?oe.deleteLike(e._id).then((function(e){t.isLiked=!1,t.getLikesNumber(e.likes.length),t.likeCard()})).catch((function(e){console.log(e)})):oe.addLike(e).then((function(e){t.isLiked=!0,t.getLikesNumber(e.likes.length),t.likeCard()})).catch((function(e){console.log(e)}))}},{handleDeleteCard:function(e,t){ce.open(),ce.handleDeleteConfirm({handleProfileFormSubmit:function(){oe.deleteCard(e._id).then((function(){t.deleteCard()})).then((function(){ce.close()})).catch((function(e){console.log(e)}))}})}});return t}Q.addEventListener("click",(function(){se.open(),te.resetValidation()}));var pe=new T(".popup_avatar",(function(e,t){var n=t.textContent;ye(t,$),oe.editUserAvatar(e.link).then((function(e){ie.setUserAvatar({link:e.avatar}),pe.close()})).catch((function(e){console.log(e)})).finally((function(){ye(t,n)}))}),Z);function ye(e,t){e.textContent=t}function he(e,t){ue.open(e,t)}document.querySelector(".profile__avatar-button").addEventListener("click",(function(){ne.resetValidation(),pe.open()})),le.setEventListeners(),se.setEventListeners(),ue.setEventListeners(),pe.setEventListeners(),ce.setEventListeners()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RCxHQUFZOUcsT0FDZCxJQUNDeUYsT0FBTSxTQUFDQyxHQUNOQyxRQUFRQyxJQUFJRixFQUNkLElBQ0NTLFNBQVEsV0FDUEYsR0FBZ0JGLEVBQVNDLEVBQzNCLEdBQ0YsR0FBR2pGLEdBVVAsU0FBU2tGLEdBQWdCRixFQUFTa0IsR0FDaENsQixFQUFRcEosWUFBY3NLLENBQ3hCLENBRUEsU0FBUzVOLEdBQWdCNkIsRUFBTUUsR0FDN0J1SixHQUFXNEIsS0FBS3JMLEVBQU1FLEVBQ3hCLENBWmVRLFNBQVNDLGNBQWMsMkJBQy9CTyxpQkFBaUIsU0FBUyxXQUMvQm1JLEdBQW9CK0Isa0JBQ3BCUSxHQUFZUCxNQUNkLElBWUFULEdBQWFvQixvQkFDYlYsR0FBYVUsb0JBQ2J2QyxHQUFXdUMsb0JBQ1hKLEdBQVlJLG9CQUNadEMsR0FBZXNDLG1CIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbWVzdG8tbWFpbi04Ly4vc3JjL3NjcmlwdHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly9tZXN0by1tYWluLTgvLi9zcmMvc2NyaXB0cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL21lc3RvLW1haW4tOC8uL3NyYy9zY3JpcHRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vbWVzdG8tbWFpbi04Ly4vc3JjL3NjcmlwdHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vbWVzdG8tbWFpbi04Ly4vc3JjL3NjcmlwdHMvUG9wdXBXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vbWVzdG8tbWFpbi04Ly4vc3JjL3NjcmlwdHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly9tZXN0by1tYWluLTgvLi9zcmMvc2NyaXB0cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly9tZXN0by1tYWluLTgvLi9zcmMvc2NyaXB0cy9BcGkuanMiLCJ3ZWJwYWNrOi8vbWVzdG8tbWFpbi04Ly4vc3JjL3NjcmlwdHMvUG9wdXBXaXRoQXBwbHkuanMiLCJ3ZWJwYWNrOi8vbWVzdG8tbWFpbi04Ly4vc3JjL3BhZ2VzL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbIlxuXG5cbi8v0KHQtdC70LXQutGC0L7RgCDQutC70LDRgdGB0LBcbmNvbnN0IGNvbmZpZyA9IHtcbiAgc2VsZWN0b3JMaXN0OiAnLmVsZW1lbnRzX19jYXJkJyxcbiAgc2VsZWN0b3JUZW1wbGF0ZTogJyNjYXJkJyxcbiAgY2FyZEltZ1NlbGVjdG9yOiAnLmVsZW1lbnRzX19pbWFnZScsXG4gIGNhcmRUaXRsZVNlbGVjdG9yOiAnLmVsZW1lbnRzX190aXRsZScsXG4gIGNhcmREZWxldGVCdG5TZWxlY3RvcjogJy5lbGVtZW50c19fZGVsZXRlLWJ1dHRvbicsXG4gIHRvZ2dsZUxpa2VTZWxlY3RvcjogJy5lbGVtZW50c19fdmVjdG9yJyxcbiAgYWN0aXZlTGlrZUJ0bkNsYXNzOiAnZWxlbWVudHNfX3ZlY3Rvcl9hY3RpdmUnLFxuICBjb3VudExpa2VzOiAnLmVsZW1lbnRzX19saWtlcy1udW1iZXInXG59XG4vL9Ca0LvQsNGB0YFcbmNsYXNzIENhcmQge1xuICBjb25zdHJ1Y3RvcihjYXJkRGF0YSwgY29uZmlnLCBoYW5kbGVDYXJkQ2xpY2ssIHVzZXJJZCwge2hhbmRsZUxpa2VDYXJkfSwge2hhbmRsZURlbGV0ZUNhcmR9KSB7XG4gICAgdGhpcy5fY2FyZERhdGEgPSBjYXJkRGF0YTtcbiAgICB0aGlzLl9uYW1lID0gY2FyZERhdGEubmFtZTtcbiAgICB0aGlzLl9saW5rID0gY2FyZERhdGEubGluaztcbiAgICB0aGlzLl9jb25maWcgPSBjb25maWc7XG4gICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrID0gaGFuZGxlQ2FyZENsaWNrO1xuICAgIFxuICAgIHRoaXMuX3VzZXJJZCA9IHVzZXJJZDtcbiAgICB0aGlzLl9oYW5kbGVMaWtlQ2FyZCA9IGhhbmRsZUxpa2VDYXJkO1xuICAgIHRoaXMuX2xpa2VzID0gY2FyZERhdGEubGlrZXNcbiAgICB0aGlzLl9oYW5kbGVEZWxldGVDYXJkID0gaGFuZGxlRGVsZXRlQ2FyZDtcbiAgICB0aGlzLl9jYXJkT3duZXIgPSBjYXJkRGF0YS5vd25lci5faWQ7XG4gIH1cblxuXG4gIC8v0JTQvtCx0LDQstC70LXQvdC40LUg0YHQstC+0LXQuSDQutCw0YDRgtC+0YfQutC4XG4gIF9nZXRUZW1wbGF0ZSgpIHtcbiAgXG4gICAgY29uc3QgbmV3Q2FyZCA9IGRvY3VtZW50XG4gICAgICAucXVlcnlTZWxlY3Rvcih0aGlzLl9jb25maWcuc2VsZWN0b3JUZW1wbGF0ZSlcbiAgICAgIC5jb250ZW50XG4gICAgICAucXVlcnlTZWxlY3RvcignLmVsZW1lbnRzX19jYXJkJylcbiAgICAgIC5jbG9uZU5vZGUodHJ1ZSk7XG5cbiAgICByZXR1cm4gbmV3Q2FyZDtcbiAgfVxuXG4gIF9kZWxldGVDYXJkRm9yU3VyZSA9ICgpID0+IHtcbiAgIHRoaXMuX2hhbmRsZURlbGV0ZUNhcmQodGhpcy5fY2FyZERhdGEsIHRoaXMpXG4gIH1cblxuICAvL9GD0LTQsNC70LXQvdC4ZSDQutCw0YDRgtC+0YfQutC4IFxuICBkZWxldGVDYXJkKCkgeyAgXG4gICAgIHRoaXMuX2VsZW1lbnQucmVtb3ZlKClcbiAgfVxuXG4gIC8v0LTQvtCx0LDQstC70LXQvdC40LUg0LvQsNC50LrQsFxuICBfdG9nZ2xlTGlrZShlbGVtZW50c0xpa2UpIHtcbiAgICBlbGVtZW50c0xpa2UuY2xhc3NMaXN0LnRvZ2dsZSh0aGlzLl9jb25maWcuYWN0aXZlTGlrZUJ0bkNsYXNzKVxuICB9XG5cbiAgLy8g0YHQu9GD0YjQsNGC0LXQu9C4INC90LAg0LTQvtCx0LDQstC70LXQvdC40LUg0LvQsNC50LrQsCwg0YPQtNCw0LvQtdC90LjQtSDQutCw0YDRgtC+0YfQutC4INC4INC+0YLQutGA0YvRgtC40LUg0YTQvtGC0L5cbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIGNvbnN0IGRlbGV0ZUNhcmQgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IodGhpcy5fY29uZmlnLmNhcmREZWxldGVCdG5TZWxlY3Rvcik7XG4gICAgY29uc3QgZWxlbWVudHNMaWtlID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKHRoaXMuX2NvbmZpZy50b2dnbGVMaWtlU2VsZWN0b3IpO1xuXG4gICAgZGVsZXRlQ2FyZC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgIHRoaXMuX2RlbGV0ZUNhcmRGb3JTdXJlKClcbiAgICB9KVxuXG4gICAgdGhpcy5fY2FyZEltYWdlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrKHRoaXMuX25hbWUsIHRoaXMuX2xpbmspXG4gICAgfSlcblxuICAgIGVsZW1lbnRzTGlrZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgIHRoaXMuX2hhbmRsZUxpa2VDYXJkKHRoaXMuX2NhcmREYXRhKTtcbiAgICB9KVxuICB9XG5cbiAgLy/QlNC+0LHQsNCy0LvQtdC90LjQtSDRgdCy0L7QtdC5INC60LDRgNGC0L7Rh9C60LhcbiAgY3JlYXRlTmV3Q2FyZCgpIHtcbiAgICB0aGlzLl9lbGVtZW50ID0gdGhpcy5fZ2V0VGVtcGxhdGUoKTtcbiAgICB0aGlzLl9jYXJkSW1hZ2UgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IodGhpcy5fY29uZmlnLmNhcmRJbWdTZWxlY3Rvcik7XG5cbiAgICB0aGlzLl9jYXJkSW1hZ2Uuc3JjID0gdGhpcy5fbGluaztcbiAgICB0aGlzLl9jYXJkSW1hZ2UuYWx0ID0gYCAke3RoaXMuX2xpbmt9LmA7XG4gICAgdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKHRoaXMuX2NvbmZpZy5jYXJkVGl0bGVTZWxlY3RvcikudGV4dENvbnRlbnQgPSB0aGlzLl9uYW1lO1xuXG4gICAgdGhpcy5fbGlrZUJ1dHRvbiA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLl9jb25maWcudG9nZ2xlTGlrZVNlbGVjdG9yKTtcbiAgICB0aGlzLl9saWtlTnVtYmVyID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKHRoaXMuX2NvbmZpZy5jb3VudExpa2VzKTtcblxuICAgIHRoaXMuX2xpa2VzID0gdGhpcy5fY2FyZERhdGEubGlrZXM7XG4gICAgdGhpcy5fbGlrZU51bWJlci5pbm5lckhUTUwgPSB0aGlzLl9saWtlcy5sZW5ndGg7XG4gICBcbiAgICB0aGlzLmlzTGlrZWQgPSBmYWxzZTtcbiAgIFxuICAgIHRoaXMuX2RlbGV0ZUJ1dHRvbiA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLl9jb25maWcuY2FyZERlbGV0ZUJ0blNlbGVjdG9yKTsgXG4gICAgdGhpcy5fc2V0RGVsZXRlQnV0dG9uKCk7XG5cbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xuXG4gICAgdGhpcy5fZ2V0Q2FyZExpa2UoKTtcbiAgICB0aGlzLmdldExpa2VzTnVtYmVyKHRoaXMuX2xpa2VzLmxlbmd0aCk7XG4gICAgcmV0dXJuIHRoaXMuX2VsZW1lbnQ7XG5cbiAgICBcbiAgfVxuXG5cbiAgX2dldENhcmRMaWtlID0gKCkgPT4ge1xuICAgIGlmICh0aGlzLl9saWtlcy5zb21lKGxpa2VyID0+IGxpa2VyLl9pZCA9PT0gdGhpcy5fdXNlcklkKSkge1xuICAgICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QuYWRkKCdlbGVtZW50c19fdmVjdG9yX2FjdGl2ZScpO1xuICAgICAgdGhpcy5pc0xpa2VkID0gdHJ1ZTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoJ2VsZW1lbnRzX192ZWN0b3JfYWN0aXZlJyk7XG4gICAgfVxuICB9XG5cbiAgZ2V0TGlrZXNOdW1iZXIgPSAobGlrZXNOdW1iZXIpID0+IHtcbiAgICB0aGlzLl9saWtlTnVtYmVyLmlubmVySFRNTCA9IGxpa2VzTnVtYmVyO1xuICB9XG5cbiAgbGlrZUNhcmQgPSAoKSA9PiB7XG4gICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QudG9nZ2xlKCdlbGVtZW50c19fdmVjdG9yX2FjdGl2ZScpO1xuICB9XG4gIF9zZXREZWxldGVCdXR0b24gPSAoKSA9PiB7XG4gICAgaWYgKHRoaXMuX2NhcmRPd25lciA9PT0gdGhpcy5fdXNlcklkKSB7XG4gICAgICB0aGlzLl9kZWxldGVCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSgnZWxlbWVudHNfX2RlbGV0ZS1idXR0b25faGlkZGVuJyk7XG4gICAgfVxuICB9XG5cbn07XG5cbmV4cG9ydCB7IENhcmQsIGNvbmZpZ30iLCJcblxuY29uc3QgZm9ybVNldHRpbmcgPSB7XG4gIGZvcm1TZWxlY3RvcjogJy5wb3B1cF9fZm9ybScsXG4gIGlucHV0U2VsZWN0b3I6ICcucG9wdXBfX2lucHV0JyxcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6ICcucG9wdXBfX3NhdmUtYnRuJyxcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogJ3BvcHVwX19zYXZlLWJ0bl9pbmFjdGl2ZScsXG4gIGlucHV0RXJyb3JDbGFzczogJ3BvcHVwX19pbnB1dF90eXBlX2Vycm9yJyxcbiAgZXJyb3JDbGFzczogJ3BvcHVwX19pbnB1dC1lcnJvcl9hY3RpdmUnXG59O1xuXG5jbGFzcyBGb3JtVmFsaWRhdG9yIHtcbiAgY29uc3RydWN0b3IoZm9ybVNldHRpbmcsIGZvcm1FbGVtZW50KSB7XG4gICAgdGhpcy5fZm9ybVNldHRpbmcgPSBmb3JtU2V0dGluZztcbiAgICB0aGlzLl9mb3JtRWxlbWVudCA9IGZvcm1FbGVtZW50XG5cbiAgICB0aGlzLl9pbnB1dExpc3QgPSBBcnJheS5mcm9tKHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5fZm9ybVNldHRpbmcuaW5wdXRTZWxlY3RvcikpO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IodGhpcy5fZm9ybVNldHRpbmcuc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xuICB9XG5cbiAgLy9cbiAgX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCwgZXJyb3JNZXNzYWdlKSB7XG4gICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihgLiR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmApO1xuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2Zvcm1TZXR0aW5nLmlucHV0RXJyb3JDbGFzcyk7XG4gICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gZXJyb3JNZXNzYWdlO1xuICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2Zvcm1TZXR0aW5nLmVycm9yQ2xhc3MpO1xuICB9XG4gIC8vXG4gIF9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAuJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYCk7XG4gICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gJyc7XG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fZm9ybVNldHRpbmcuaW5wdXRFcnJvckNsYXNzKTtcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9mb3JtU2V0dGluZy5lcnJvckNsYXNzKTtcblxuICB9XG4gIC8vXG4gIF9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KSB7XG4gICAgaWYgKCFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpIHtcbiAgICAgIHRoaXMuX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCwgaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcbiAgICB9XG4gIH1cbiAgLy9cblxuICByZXNldFZhbGlkYXRpb24oKSB7XG4gICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcblxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudClcbiAgICB9KTtcblxuICB9XG5cbiAgX3RvZ2dsZUJ1dHRvblN0YXRlKCkge1xuICAgIGlmICh0aGlzLl9oYXNJbnZhbGlkSW5wdXQoKSkge1xuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5hZGQodGhpcy5fZm9ybVNldHRpbmcuaW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSB0cnVlO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9mb3JtU2V0dGluZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xuICAgIH1cbiAgfVxuICAvL1xuICBfaGFzSW52YWxpZElucHV0KCkge1xuICBcbiAgICByZXR1cm4gdGhpcy5faW5wdXRMaXN0LnNvbWUoKGlucHV0RWxlbWVudCkgPT4ge1xuICAgICAgcmV0dXJuICFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQ7XG4gICAgfSk7XG4gIH1cbiAgLy9cbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XG5cbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgICBpbnB1dEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCAoKSA9PiB7XG4gICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpO1xuICAgICAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cbiAgLy9cbiAgZW5hYmxlVmFsaWRhdGlvbigpIHtcbiAgICB0aGlzLl9mb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCAoZXZ0KSA9PiB7XG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICB9KTtcblxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG4gIH1cbn1cblxuZXhwb3J0IHsgRm9ybVZhbGlkYXRvciwgZm9ybVNldHRpbmcgfSIsImV4cG9ydCBjbGFzcyBTZWN0aW9ue1xuICAgIGNvbnN0cnVjdG9yKHtpdGVtcywgcmVuZGVyZXJ9LCBzZWxlY3Rvcikge1xuICAgICAgdGhpcy5fcmVuZGVySXRlbXMgPSBpdGVtczsgXG4gICAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xuICAgICAgdGhpcy5fY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihzZWxlY3Rvcik7XG5cbiAgICB9XG5cbiAgICByZW5kZXJJdGVtcyhpdGVtcykge1xuICAgICAgICBpdGVtcy5mb3JFYWNoKChpdGVtKT0+dGhpcy5fcmVuZGVyZXIoaXRlbSkpXG4gICAgICB9XG5cbiAgICAgIGFkZEl0ZW0oaXRlbSkge1xuICAgICAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChpdGVtKVxuICAgICAgfVxuICAgIH1cbiIsIlxuZXhwb3J0IGNsYXNzIFBvcHVwIHtcbiAgICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XG4gICAgICAgIHRoaXMuX3BvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwb3B1cFNlbGVjdG9yKTtcbiAgICAgICAgdGhpcy5faGFuZGxlRXNjQ2xvc2UgPSB0aGlzLl9oYW5kbGVFc2NDbG9zZS5iaW5kKHRoaXMpXG4gICAgfVxuXG5cbm9wZW4oKSB7XG4gICAgdGhpcy5fcG9wdXAuY2xhc3NMaXN0LmFkZCgncG9wdXBfb3BlbmVkJyk7XG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTsgXG59XG5cbmNsb3NlKCkge1xuICAgIHRoaXMuX3BvcHVwLmNsYXNzTGlzdC5yZW1vdmUoJ3BvcHVwX29wZW5lZCcpO1xuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSlcbiB9XG5cbl9oYW5kbGVFc2NDbG9zZShldnQpIHtcbiAgICBpZiAoZXZ0LmtleSA9PT0gXCJFc2NhcGVcIikge1xuICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICB9O1xufVxuXG5zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9wb3B1cC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCAoZXZ0KSA9PiB7XG4gICAgICAgIGlmIChldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygncG9wdXBfb3BlbmVkJykpIHtcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ3BvcHVwX19jbG9zZS1wb3B1cCcpKSB7XG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgIH1cbiAgICB9KVxuICB9XG5cbn1cblxuXG5cblxuXG5cbiIsImltcG9ydCB7UG9wdXB9IGZyb20gJy4vUG9wdXAuanMnXG5cblxuZXhwb3J0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXB7XG4gICAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xuICAgICAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcbiAgICAgICAgdGhpcy5fcG9wdXBCaWdJbWFnZSA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fYmlnLWltYWdlJyk7XG4gICAgICAgIHRoaXMuX3BvcHVwVGl0bGUgPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2JpZy10aXRsZScpO1xuICAgIH1cblxuXG4gICAgb3BlbihuYW1lLCBsaW5rKSB7XG4gICAgICAgIHN1cGVyLm9wZW4oKTtcbiAgICAgICAgdGhpcy5fcG9wdXBCaWdJbWFnZS5zcmMgPSBsaW5rO1xuICAgICAgICB0aGlzLl9wb3B1cEJpZ0ltYWdlLmFsdCA9IG5hbWU7XG4gICAgICAgIHRoaXMuX3BvcHVwVGl0bGUudGV4dENvbnRlbnQgPSAgbmFtZTtcblxuICAgICAgfTtcbiAgICAgIFxuICAgICAgXG59IiwiaW1wb3J0IHsgUG9wdXAgfSBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuXG5leHBvcnQgY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3RvciwgaGFuZGxlUHJvZmlsZUZvcm1TdWJtaXQsIGJ0bkZvcm1TZWxlY3Rvcikge1xuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xuICAgIHRoaXMuX2hhbmRsZVByb2ZpbGVGb3JtU3VibWl0ID0gaGFuZGxlUHJvZmlsZUZvcm1TdWJtaXQ7XG4gICAgdGhpcy5fZm9ybSA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fZm9ybScpO1xuICAgIHRoaXMuX2lucHV0TGlzdCA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvckFsbCgnLnBvcHVwX19pbnB1dCcpO1xuICAgIHRoaXMuX2J0bkZvcm0gPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoYnRuRm9ybVNlbGVjdG9yKVxuICB9XG5cblxuXG4gIF9nZXRJbnB1dFZhbHVlcyA9ICgpID0+IHtcbiAgICBjb25zdCBpbnB1dFZhbHVlcyA9IHt9O1xuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKGlucHV0SXRlbSA9PiB7XG4gICAgICBpbnB1dFZhbHVlc1tpbnB1dEl0ZW0ubmFtZV0gPSBpbnB1dEl0ZW0udmFsdWU7XG4gICAgfSlcbiAgICByZXR1cm4gaW5wdXRWYWx1ZXM7XG4gIH1cblxuICBnZXRJbnB1dFZhbHVlcygpIHtcbiAgICByZXR1cm4gdGhpcy5faW5wdXRGb3JtVmFsdWVzO1xuICB9XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMgPSAoKSA9PiB7XG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuICAgIHRoaXMuX2Zvcm0uYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgKGUpID0+IHtcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgIHRoaXMuX2hhbmRsZVByb2ZpbGVGb3JtU3VibWl0KHRoaXMuX2dldElucHV0VmFsdWVzKCksIHRoaXMuX2J0bkZvcm0pO1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH0pO1xuICB9XG5cbiAgY2xvc2UoKSB7XG4gICAgc3VwZXIuY2xvc2UoKTtcbiAgICB0aGlzLl9mb3JtLnJlc2V0KCk7XG4gIH1cbn0iLCJcbmV4cG9ydCBjbGFzcyBVc2VySW5mbyB7XG4gICAgXG4gICAgY29uc3RydWN0b3IoeyBwcm9maWxlTmFtZVNlbGVjdG9yLCBwcm9maWxlSW5mb1NlbGVjdG9yLCAgYXZhdGFyU2VsZWN0b3IgfSkge1xuICAgICAgdGhpcy5fbmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocHJvZmlsZU5hbWVTZWxlY3Rvcik7XG4gICAgICB0aGlzLl9pbmZvID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwcm9maWxlSW5mb1NlbGVjdG9yKTtcbiAgICAgIHRoaXMuX3VzZXJBdmF0YXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGF2YXRhclNlbGVjdG9yKVxuICAgIH1cbiAgXG4gICAgXG4gICAgZ2V0VXNlckluZm8oKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBuYW1lOiB0aGlzLl9uYW1lLnRleHRDb250ZW50LFxuICAgICAgICBpbmZvOiB0aGlzLl9pbmZvLnRleHRDb250ZW50LFxuICAgICAgfTtcbiAgICB9XG4gIFxuICAgIHNldFVzZXJJbmZvKGlucHV0VmFsdWVzKSB7XG4gICAgICB0aGlzLl9uYW1lLnRleHRDb250ZW50ID0gaW5wdXRWYWx1ZXMubmFtZTtcbiAgICAgIHRoaXMuX2luZm8udGV4dENvbnRlbnQgPSBpbnB1dFZhbHVlcy5hYm91dDtcbiAgICB9XG5cbiAgICBzZXRVc2VyQXZhdGFyKHtsaW5rfSkge1xuICAgICAgdGhpcy5fdXNlckF2YXRhci5zcmMgPSBsaW5rO1xuICAgIH1cbiAgfVxuXG4iLCJleHBvcnQgY2xhc3MgQXBpIHtcbiAgY29uc3RydWN0b3Iob3B0aW9ucykge1xuICAgIHRoaXMuX2Jhc2VVcmwgPSBvcHRpb25zLmJhc2VVcmw7XG4gICAgdGhpcy5faGVhZGVycyA9IG9wdGlvbnMuaGVhZGVycztcbiAgfVxuXG5cbiAgX2dldFJlc3BvbnNlKHJlcykge1xuICAgIGlmIChyZXMub2spIHtcbiAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgIH1cbiAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYNCe0YjQuNCx0LrQsDogJHtyZXMuc3RhdHVzfWApO1xufVxuXG4gIGdldEluaXRpYWxDYXJkcygpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XG4gICAgICBtZXRob2Q6ICdHRVQnLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVyc1xuICAgIH0pXG4gICAgICAudGhlbih0aGlzLl9nZXRSZXNwb25zZSlcbiAgfVxuXG5cbiAgICAvLyBcbiAgICBnZXRVc2VyRGF0YSgpIHtcbiAgICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcbiAgICAgICAgICBtZXRob2Q6ICdHRVQnLFxuICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICAgIH0pXG4gICAgICAgIC50aGVuKHRoaXMuX2dldFJlc3BvbnNlKVxuICAgIH1cbiAgXG4gICAgLy8gXG4gICAgZWRpdFVzZXJEYXRhKHVzZXJJbmZvKSB7XG4gICAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XG4gICAgICAgICAgbWV0aG9kOiAnUEFUQ0gnLFxuICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkodXNlckluZm8pXG4gICAgICAgIH0pXG4gICAgICAgIC50aGVuKHRoaXMuX2dldFJlc3BvbnNlKVxuICAgIH1cbi8vIFxuICAgIGNyZWF0ZUNhcmQoZGF0YSkge1xuICAgICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCx7XG4gICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShkYXRhKVxuICAgICAgfSlcbiAgICAgIC50aGVuKHRoaXMuX2dldFJlc3BvbnNlKTtcbiAgICB9XG4gICAgYWRkTGlrZShkYXRhKSB7XG4gICAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtkYXRhLl9pZH0vbGlrZXNgLCB7XG4gICAgICAgIG1ldGhvZDogJ1BVVCcsXG4gICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KGRhdGEpXG4gICAgICB9KVxuICAgICAgLnRoZW4odGhpcy5fZ2V0UmVzcG9uc2UpO1xuICAgIH1cbiAgXG4gICAgZGVsZXRlTGlrZShjYXJkSWQpIHtcbiAgICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH0vbGlrZXNgLCB7XG4gICAgICAgIG1ldGhvZDogJ0RFTEVURScsXG4gICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnNcbiAgICAgIH0pXG4gICAgICAudGhlbih0aGlzLl9nZXRSZXNwb25zZSk7XG4gICAgfVxuXG4gICAgZWRpdFVzZXJBdmF0YXIoYXZhdGFyVXJsKSB7XG4gICAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWUvYXZhdGFyYCwge1xuICAgICAgICAgIG1ldGhvZDogJ1BBVENIJyxcbiAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgIGF2YXRhciA6IGF2YXRhclVybFxuICAgICAgICAgIH0pXG4gICAgICAgIH0pXG4gICAgICAgIC50aGVuKHRoaXMuX2dldFJlc3BvbnNlKTtcbiAgICB9XG5cbiAgICBkZWxldGVDYXJkKGNhcmRJZCkge1xuICAgICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfWAsIHtcbiAgICAgICAgbWV0aG9kOiAnREVMRVRFJyxcbiAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVyc1xuICAgICAgfSlcbiAgICAgIC50aGVuKHRoaXMuX2dldFJlc3BvbnNlKTtcbiAgICB9XG4gIFxuXG59IiwiaW1wb3J0IHsgUG9wdXAgfSBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuXG5leHBvcnQgY2xhc3MgUG9wdXBXaXRoQXBwbHkgZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcbiAgICB0aGlzLl9mb3JtID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcignLnBvcHVwX19mb3JtJyk7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcignLnBvcHVwX19zYXZlLWJ0bicpO1xuICB9XG5cbiAgaGFuZGxlRGVsZXRlQ29uZmlybSh7IGhhbmRsZVByb2ZpbGVGb3JtU3VibWl0IH0pIHtcbiAgICB0aGlzLl9oYW5kbGVQcm9maWxlRm9ybVN1Ym1pdCA9IGhhbmRsZVByb2ZpbGVGb3JtU3VibWl0O1xuICB9XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMgPSAoKSA9PiB7XG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICB0aGlzLl9mb3JtLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIChlKSA9PiB7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB0aGlzLl9oYW5kbGVQcm9maWxlRm9ybVN1Ym1pdCgpO1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH0pO1xuICB9XG59XG4iLCJpbXBvcnQgeyBDYXJkLCBjb25maWd9IGZyb20gXCIuLi9zY3JpcHRzL0NhcmQuanNcIjtcbmltcG9ydCB7IEZvcm1WYWxpZGF0b3IsIGZvcm1TZXR0aW5nIH0gZnJvbSBcIi4uL3NjcmlwdHMvRm9ybVZhbGlkYXRvci5qc1wiO1xuaW1wb3J0IHsgU2VjdGlvbiB9IGZyb20gJy4uL3NjcmlwdHMvU2VjdGlvbi5qcyc7XG5pbXBvcnQgeyBQb3B1cCB9IGZyb20gJy4uL3NjcmlwdHMvUG9wdXAuanMnO1xuaW1wb3J0IHsgUG9wdXBXaXRoSW1hZ2UgfSBmcm9tICcuLi9zY3JpcHRzL1BvcHVwV2l0aEltYWdlLmpzJztcbmltcG9ydCB7IFBvcHVwV2l0aEZvcm0gfSBmcm9tICcuLi9zY3JpcHRzL1BvcHVwV2l0aEZvcm0uanMnO1xuaW1wb3J0IHsgVXNlckluZm8gfSBmcm9tICcuLi9zY3JpcHRzL1VzZXJJbmZvLmpzJztcbmltcG9ydCB7IEFwaSB9IGZyb20gJy4uL3NjcmlwdHMvQXBpLmpzJztcbmltcG9ydCAnLi4vcGFnZXMvaW5kZXguY3NzJztcbmltcG9ydCB7IFBvcHVwV2l0aEFwcGx5IH0gZnJvbSBcIi4uL3NjcmlwdHMvUG9wdXBXaXRoQXBwbHkuanNcIjtcblxuXG5jb25zdCBvcGVuUHJvZmlsZUJ1dHR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fZWRpdC1idXR0b24nKTsgLy8g0JrQvdC+0L/QutC4INC00LvRjyDQv9C+0LrQsNC30LAg0L7QutC90LBcbmNvbnN0IGlucHV0TmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNpbnB1dC1uYW1lJyk7XG5jb25zdCBpbnB1dEluZm8gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjaW5wdXQtaW5mbycpO1xuLy81INGB0L/RgNC40L3RglxuY29uc3Qgb3BlbkNhcmRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fYWRkLWJ1dHRvbicpXG5cbmNvbnN0IGJpZ0ltYWdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX19iaWctaW1hZ2UnKTtcbmNvbnN0IGJpZ1RpdGxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX19iaWctdGl0bGUnKTtcbmNvbnN0IGNhcmRJbWFnZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9pbWFnZScpXG5cblxuLy8g0KHQtdC70LXQutGC0L7RgNGLINC/0L7Qv9Cw0L/QvtCyOlxuY29uc3QgcHJvZmlsZVBvcHVwU2VsZWN0b3IgPSAnLnBvcHVwX3Byb2ZpbGUnO1xuY29uc3QgYWRkQ2FyZFBvcHVwU2VsZWN0b3IgPSAnLnBvcHVwX2NhcmQnO1xuY29uc3QgaW1hZ2VQb3B1cFNlbGVjdG9yID0gJy5wb3B1cF9pbWFnZSc7XG5jb25zdCBhdmF0YXJQb3B1cFNlbGVjdG9yID0gJy5wb3B1cF9hdmF0YXInO1xuXG5cbmNvbnN0IGZvcm1FZGl0UHJvZmlsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2Zvcm0tcHJvZmlsZVwiKTtcbmNvbnN0IGZvcm1BZGRDYXJkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fZm9ybS1jYXJkXCIpO1xuY29uc3QgZm9ybUF2YXRhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fZm9ybS1hdmF0YXInKVxuXG5cbi8vINCh0LXQu9C10LrRgtC+0YAg0LTQu9GPINCy0YvQsdC+0YDQsCDQutC+0L3RgtC10LnQvdC10YDQsCDQutCw0YDRgtC+0YfQtdC6OlxuY29uc3Qgc2VsZWN0b3IgPSAnLmVsZW1lbnRzX19saXN0JztcblxuY29uc3QgYnRuRm9ybVNlbGVjdG9yID0gJy5wb3B1cF9fc2F2ZS1idG4nO1xuY29uc3QgYnRuTG9hZGluZ1RleHQgPSAn0KHQvtGF0YDQsNC90LXQvdC40LUuLi4nO1xuXG4vLzlcbmNvbnN0IGFwaU9wdGlvbnMgPSB7XG4gIGJhc2VVcmw6ICdodHRwczovL21lc3RvLm5vbW9yZXBhcnRpZXMuY28vdjEvY29ob3J0LTYyJyxcbiAgaGVhZGVyczoge1xuICAgIGF1dGhvcml6YXRpb246ICdiYzQ0MGJjZS04OGQyLTQwZGUtODEzZi05MTg2YTUyMTFhNzEnLFxuICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcbiAgfVxufTtcblxuXG5jb25zdCB2YWxpZGF0b3JQcm9maWxlRm9ybSA9IG5ldyBGb3JtVmFsaWRhdG9yKGZvcm1TZXR0aW5nLCBmb3JtRWRpdFByb2ZpbGUpO1xudmFsaWRhdG9yUHJvZmlsZUZvcm0uZW5hYmxlVmFsaWRhdGlvbigpXG5jb25zdCB2YWxpZGF0b3JDYXJkRm9ybSA9IG5ldyBGb3JtVmFsaWRhdG9yKGZvcm1TZXR0aW5nLCBmb3JtQWRkQ2FyZCk7XG52YWxpZGF0b3JDYXJkRm9ybS5lbmFibGVWYWxpZGF0aW9uKClcbmNvbnN0IGF2YXRhckZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihmb3JtU2V0dGluZywgZm9ybUF2YXRhcilcbmF2YXRhckZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpXG4vLyDRjdC60LfQtdC80L/Qu9GP0YAg0LrQu9Cw0YHRgdCwIEFwaTpcbmNvbnN0IGFwaSA9IG5ldyBBcGkoYXBpT3B0aW9ucyk7XG5cbi8vICB1c2VySWRcbmxldCB1c2VySWQ7XG5cblxuXG5jb25zdCBkYXRhID0ge1xuICBwcm9maWxlTmFtZVNlbGVjdG9yOiAnLnByb2ZpbGVfX25hbWUnLFxuICBwcm9maWxlSW5mb1NlbGVjdG9yOiAnLnByb2ZpbGVfX3RleHQnLFxuICBhdmF0YXJTZWxlY3RvcjogJy5wcm9maWxlX19hdmF0YXInXG59XG5cbmNvbnN0IHVzZXJEYXRhID0gbmV3IFVzZXJJbmZvKGRhdGEpO1xuY29uc3QgaW1hZ2VQb3B1cCA9IG5ldyBQb3B1cFdpdGhJbWFnZShpbWFnZVBvcHVwU2VsZWN0b3IpO1xuY29uc3QgcG9wdXBXaXRoQXBwbHkgPSBuZXcgUG9wdXBXaXRoQXBwbHkoJy5wb3B1cF9kZWxldGUnKTtcblxuXG5cbmNvbnN0IHNlY3Rpb24gPSBuZXcgU2VjdGlvbih7XG4gIHJlbmRlcmVyOiAoaXRlbSkgPT4ge1xuICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gY3JlYXRlQ2FyZChpdGVtKS5jcmVhdGVOZXdDYXJkKCk7XG4gICAgc2VjdGlvbi5hZGRJdGVtKGNhcmRFbGVtZW50KTtcbiAgfSxcbn0sIHNlbGVjdG9yKVxuXG5cblxuLy/QtNCw0L3QvdGL0LUg0YEg0YHQtdGA0LLQtdGA0LAgXG5hcGkuZ2V0VXNlckRhdGEoKVxuICAudGhlbigodXNlcikgPT4ge1xuICAgIHVzZXJEYXRhLnNldFVzZXJJbmZvKHsgbmFtZTogdXNlci5uYW1lLCBhYm91dDogdXNlci5hYm91dCB9KTtcbiAgICB1c2VyRGF0YS5zZXRVc2VyQXZhdGFyKHsgbGluazogdXNlci5hdmF0YXIgfSk7XG4gICAgdXNlcklkID0gdXNlci5faWQ7XG4gICAgYXBpLmdldEluaXRpYWxDYXJkcygpXG4gICAgICAudGhlbigoY2FyZHMpID0+IHtcbiAgICAgICAgc2VjdGlvbi5yZW5kZXJJdGVtcyhjYXJkcyk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICAgIH0pO1xuICB9KVxuICAuY2F0Y2goKGVycikgPT4gYWxlcnQoZXJyKSk7XG5cbmNvbnN0IHByb2ZpbGVQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKHByb2ZpbGVQb3B1cFNlbGVjdG9yLFxuICAodXNlckluZm8sIGJ0bkZvcm0pID0+IHtcbiAgICBjb25zdCBidG5Gb3JtSW5pdGlhbFRleHQgPSBidG5Gb3JtLnRleHRDb250ZW50O1xuICAgIHNob3dMb2FkaW5nVGV4dChidG5Gb3JtLCBidG5Mb2FkaW5nVGV4dCk7XG4gICAgYXBpLmVkaXRVc2VyRGF0YSh1c2VySW5mbylcbiAgICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgICAgdXNlckRhdGEuc2V0VXNlckluZm8ocmVzKTtcbiAgICAgIH0pXG5cbiAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgcHJvZmlsZVBvcHVwLmNsb3NlKCk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKChlcnIpID0+IHthbGVydChlcnIpXG4gICAgICAgIHVzZXJEYXRhLnNldFVzZXJJbmZvKHVzZXJJbmZvKVxuICAgICAgfSlcbiAgICBcbiAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICBzaG93TG9hZGluZ1RleHQoYnRuRm9ybSwgYnRuRm9ybUluaXRpYWxUZXh0KVxuICAgIH0pXG4gIH0sIGJ0bkZvcm1TZWxlY3Rvcik7Ly8gcHJvZmlsZVN1Ym1pdEhhbmRsZXIpO1xuXG5cbi8v0KHQu9GD0YjQsNGC0LXQu9GMINC90LAg0L7RgtC60YDRi9GC0LjQtSDQtNC70Y8g0L/RgNC+0YTQuNC70Y9cbm9wZW5Qcm9maWxlQnV0dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgY29uc3QgaW5mb09iamVjdCA9IHVzZXJEYXRhLmdldFVzZXJJbmZvKCk7XG4gIGlucHV0TmFtZS52YWx1ZSA9IGluZm9PYmplY3QubmFtZTtcbiAgaW5wdXRJbmZvLnZhbHVlID0gaW5mb09iamVjdC5pbmZvO1xuICB2YWxpZGF0b3JQcm9maWxlRm9ybS5yZXNldFZhbGlkYXRpb24oKTtcbiAgcHJvZmlsZVBvcHVwLm9wZW4oKVxufSk7XG5cbi8vINGB0LDQsdC80LjRgtCwINC00LvRjyDQutCw0YDRgtC+0YfQtdC6XG5jb25zdCBhZGRDYXJkUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcbiAgYWRkQ2FyZFBvcHVwU2VsZWN0b3IsXG4gIChkYXRhLCBidG5Gb3JtKSA9PiB7XG4gICAgY29uc3QgYnRuRm9ybUluaXRpYWxUZXh0ID0gYnRuRm9ybS50ZXh0Q29udGVudDtcbiAgICBzaG93TG9hZGluZ1RleHQoYnRuRm9ybSwgYnRuTG9hZGluZ1RleHQpO1xuICAgIGFwaS5jcmVhdGVDYXJkKGRhdGEpXG4gICAgICAudGhlbigoaXRlbSkgPT4ge1xuICAgICAgICBjcmVhdGVDYXJkKGl0ZW0pO1xuICAgICAgICBzZWN0aW9uLmFkZEl0ZW0oY3JlYXRlQ2FyZChpdGVtKS5jcmVhdGVOZXdDYXJkKCkpO1xuICAgICAgICBhZGRDYXJkUG9wdXAuY2xvc2UoKVxuICAgICAgfSlcbiAgICBcbiAgICAuY2F0Y2goKGVycikgPT4gYWxlcnQoZXJyKSlcbiAgXG4gIC5maW5hbGx5KCgpID0+IHtcbiAgICBzaG93TG9hZGluZ1RleHQoYnRuRm9ybSwgYnRuRm9ybUluaXRpYWxUZXh0KVxuICB9KVxufSwgYnRuRm9ybVNlbGVjdG9yKTtcblxuLy8g0YHQu9GD0YjQsNGC0LXQu9GMINC90LAg0L7RgtC60YDRi9GC0LjQtSDQv9C+0L/QsNC/0LAgY2FyZFxub3BlbkNhcmRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gIGFkZENhcmRQb3B1cC5vcGVuKCk7XG4gIHZhbGlkYXRvckNhcmRGb3JtLnJlc2V0VmFsaWRhdGlvbigpO1xufSk7XG5cblxuXG5cbmZ1bmN0aW9uIGNyZWF0ZUNhcmQoY2FyZERhdGEpIHtcbiAgY29uc3QgY2FyZCA9IG5ldyBDYXJkKGNhcmREYXRhLCBjb25maWcsIGhhbmRsZUNhcmRDbGljaywgdXNlcklkLCB7XG4gICAgaGFuZGxlTGlrZUNhcmQ6IChkYXRhKSA9PiB7XG4gICAgICBpZiAoY2FyZC5pc0xpa2VkKSB7XG4gICAgICAgIGFwaS5kZWxldGVMaWtlKGRhdGEuX2lkKVxuICAgICAgICAgIC50aGVuKChkYXRhKSA9PiB7XG4gICAgICAgICAgICBjYXJkLmlzTGlrZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIGNhcmQuZ2V0TGlrZXNOdW1iZXIoZGF0YS5saWtlcy5sZW5ndGgpO1xuICAgICAgICAgICAgY2FyZC5saWtlQ2FyZCgpO1xuICAgICAgICAgIH0pXG4gICAgICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBlbHNlIHtcbiAgICAgICAgYXBpLmFkZExpa2UoZGF0YSlcbiAgICAgICAgICAudGhlbigoZGF0YSkgPT4ge1xuICAgICAgICAgICAgY2FyZC5pc0xpa2VkID0gdHJ1ZTtcbiAgICAgICAgICAgIGNhcmQuZ2V0TGlrZXNOdW1iZXIoZGF0YS5saWtlcy5sZW5ndGgpO1xuICAgICAgICAgICAgY2FyZC5saWtlQ2FyZCgpO1xuICAgICAgICAgIH0pXG4gICAgICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuICB9LFxuICB7XG4gICAgaGFuZGxlRGVsZXRlQ2FyZDogKGRhdGEsIGNhcmQpID0+IHtcbiAgICAgIHBvcHVwV2l0aEFwcGx5Lm9wZW4oKTtcbiAgICAgIHBvcHVwV2l0aEFwcGx5LmhhbmRsZURlbGV0ZUNvbmZpcm0oe1xuICAgICAgICBoYW5kbGVQcm9maWxlRm9ybVN1Ym1pdDogKCkgPT4ge1xuICAgICAgICAgIGFwaS5kZWxldGVDYXJkKGRhdGEuX2lkKVxuICAgICAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgICAgIGNhcmQuZGVsZXRlQ2FyZCgpO1xuICAgICAgICAgIH0pXG4gICAgICAgICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgcG9wdXBXaXRoQXBwbHkuY2xvc2UoKTtcbiAgICAgICAgICB9KVxuICAgICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gIH0sXG4gICk7XG4gIHJldHVybiBjYXJkXG59XG5cbmNvbnN0IGF2YXRhclBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oJy5wb3B1cF9hdmF0YXInLCBcbiAgIChpbnB1dERhdGEsIGJ0bkZvcm0pID0+IHtcbiAgICBjb25zdCBidG5Gb3JtSW5pdGlhbFRleHQgPSBidG5Gb3JtLnRleHRDb250ZW50O1xuICAgIHNob3dMb2FkaW5nVGV4dChidG5Gb3JtLCBidG5Mb2FkaW5nVGV4dCk7XG4gICAgYXBpLmVkaXRVc2VyQXZhdGFyKGlucHV0RGF0YS5saW5rKVxuICAgICAgLnRoZW4oKHVzZXIpID0+IHtcbiAgICAgICAgdXNlckRhdGEuc2V0VXNlckF2YXRhcih7IGxpbms6IHVzZXIuYXZhdGFyIH0pO1xuICAgICAgICBhdmF0YXJQb3B1cC5jbG9zZSgpO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgICB9KVxuICAgICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgICBzaG93TG9hZGluZ1RleHQoYnRuRm9ybSwgYnRuRm9ybUluaXRpYWxUZXh0KVxuICAgICAgfSlcbiAgICB9LCBidG5Gb3JtU2VsZWN0b3JcbiAgKVxuXG4vLyDQntGC0LrRgNGL0LLQsNC10Lwg0YTQvtGA0LzRgyDQsNCy0LDRgtCw0YDQsFxuY29uc3QgYXZhdGFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2F2YXRhci1idXR0b24nKTtcbmF2YXRhci5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgYXZhdGFyRm9ybVZhbGlkYXRvci5yZXNldFZhbGlkYXRpb24oKTtcbiAgYXZhdGFyUG9wdXAub3BlbigpO1xufSk7XG5cbmZ1bmN0aW9uIHNob3dMb2FkaW5nVGV4dChidG5Gb3JtLCB0ZXh0KSB7XG4gIGJ0bkZvcm0udGV4dENvbnRlbnQgPSB0ZXh0O1xufVxuXG5mdW5jdGlvbiBoYW5kbGVDYXJkQ2xpY2sobmFtZSwgbGluaykge1xuICBpbWFnZVBvcHVwLm9wZW4obmFtZSwgbGluayk7XG59XG5cblxuLy8g0L7QsdGA0LDQsdC+0YLRh9C40LrQuCDRgdC+0LHRi9GC0LjQuSDQv9C+0L/QsNC/0L7QslxucHJvZmlsZVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5hZGRDYXJkUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbmltYWdlUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbmF2YXRhclBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5wb3B1cFdpdGhBcHBseS5zZXRFdmVudExpc3RlbmVycygpO1xuXG5cblxuXG5cblxuIl0sIm5hbWVzIjpbImNvbmZpZyIsInNlbGVjdG9yTGlzdCIsInNlbGVjdG9yVGVtcGxhdGUiLCJjYXJkSW1nU2VsZWN0b3IiLCJjYXJkVGl0bGVTZWxlY3RvciIsImNhcmREZWxldGVCdG5TZWxlY3RvciIsInRvZ2dsZUxpa2VTZWxlY3RvciIsImFjdGl2ZUxpa2VCdG5DbGFzcyIsImNvdW50TGlrZXMiLCJDYXJkIiwiY2FyZERhdGEiLCJoYW5kbGVDYXJkQ2xpY2siLCJ1c2VySWQiLCJfcmVmIiwiX3JlZjIiLCJfdGhpcyIsImhhbmRsZUxpa2VDYXJkIiwiaGFuZGxlRGVsZXRlQ2FyZCIsIl9jbGFzc0NhbGxDaGVjayIsIl9kZWZpbmVQcm9wZXJ0eSIsIl9oYW5kbGVEZWxldGVDYXJkIiwiX2NhcmREYXRhIiwiX2xpa2VzIiwic29tZSIsImxpa2VyIiwiX2lkIiwiX3VzZXJJZCIsIl9saWtlQnV0dG9uIiwiY2xhc3NMaXN0IiwiYWRkIiwiaXNMaWtlZCIsInJlbW92ZSIsImxpa2VzTnVtYmVyIiwiX2xpa2VOdW1iZXIiLCJpbm5lckhUTUwiLCJ0b2dnbGUiLCJfY2FyZE93bmVyIiwiX2RlbGV0ZUJ1dHRvbiIsInRoaXMiLCJfbmFtZSIsIm5hbWUiLCJfbGluayIsImxpbmsiLCJfY29uZmlnIiwiX2hhbmRsZUNhcmRDbGljayIsIl9oYW5kbGVMaWtlQ2FyZCIsImxpa2VzIiwib3duZXIiLCJrZXkiLCJ2YWx1ZSIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJfZWxlbWVudCIsImVsZW1lbnRzTGlrZSIsIl90aGlzMiIsImRlbGV0ZUNhcmQiLCJhZGRFdmVudExpc3RlbmVyIiwiX2RlbGV0ZUNhcmRGb3JTdXJlIiwiX2NhcmRJbWFnZSIsIl9nZXRUZW1wbGF0ZSIsInNyYyIsImFsdCIsImNvbmNhdCIsInRleHRDb250ZW50IiwibGVuZ3RoIiwiX3NldERlbGV0ZUJ1dHRvbiIsIl9zZXRFdmVudExpc3RlbmVycyIsIl9nZXRDYXJkTGlrZSIsImdldExpa2VzTnVtYmVyIiwiZm9ybVNldHRpbmciLCJmb3JtU2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsIkZvcm1WYWxpZGF0b3IiLCJmb3JtRWxlbWVudCIsIl9mb3JtU2V0dGluZyIsIl9mb3JtRWxlbWVudCIsIl9pbnB1dExpc3QiLCJBcnJheSIsImZyb20iLCJxdWVyeVNlbGVjdG9yQWxsIiwiX3N1Ym1pdEJ1dHRvbiIsImlucHV0RWxlbWVudCIsImVycm9yTWVzc2FnZSIsImVycm9yRWxlbWVudCIsImlkIiwidmFsaWRpdHkiLCJ2YWxpZCIsIl9oaWRlSW5wdXRFcnJvciIsIl9zaG93SW5wdXRFcnJvciIsInZhbGlkYXRpb25NZXNzYWdlIiwiX3RvZ2dsZUJ1dHRvblN0YXRlIiwiZm9yRWFjaCIsIl9oYXNJbnZhbGlkSW5wdXQiLCJkaXNhYmxlZCIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJldnQiLCJwcmV2ZW50RGVmYXVsdCIsIlNlY3Rpb24iLCJzZWxlY3RvciIsIml0ZW1zIiwicmVuZGVyZXIiLCJfcmVuZGVySXRlbXMiLCJfcmVuZGVyZXIiLCJfY29udGFpbmVyIiwiaXRlbSIsInByZXBlbmQiLCJQb3B1cCIsInBvcHVwU2VsZWN0b3IiLCJfcG9wdXAiLCJfaGFuZGxlRXNjQ2xvc2UiLCJiaW5kIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImNsb3NlIiwidGFyZ2V0IiwiY29udGFpbnMiLCJQb3B1cFdpdGhJbWFnZSIsIl9Qb3B1cCIsIl9pbmhlcml0cyIsIl9zdXBlciIsImNhbGwiLCJfcG9wdXBCaWdJbWFnZSIsIl9wb3B1cFRpdGxlIiwiX2dldCIsIl9nZXRQcm90b3R5cGVPZiIsInByb3RvdHlwZSIsIlBvcHVwV2l0aEZvcm0iLCJoYW5kbGVQcm9maWxlRm9ybVN1Ym1pdCIsImJ0bkZvcm1TZWxlY3RvciIsIl90aGlzU3VwZXIiLCJfYXNzZXJ0VGhpc0luaXRpYWxpemVkIiwiaW5wdXRWYWx1ZXMiLCJpbnB1dEl0ZW0iLCJfZm9ybSIsImUiLCJfaGFuZGxlUHJvZmlsZUZvcm1TdWJtaXQiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJfYnRuRm9ybSIsIl9pbnB1dEZvcm1WYWx1ZXMiLCJyZXNldCIsIlVzZXJJbmZvIiwicHJvZmlsZU5hbWVTZWxlY3RvciIsInByb2ZpbGVJbmZvU2VsZWN0b3IiLCJhdmF0YXJTZWxlY3RvciIsIl9pbmZvIiwiX3VzZXJBdmF0YXIiLCJpbmZvIiwiYWJvdXQiLCJBcGkiLCJvcHRpb25zIiwiX2Jhc2VVcmwiLCJiYXNlVXJsIiwiX2hlYWRlcnMiLCJoZWFkZXJzIiwicmVzIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsInN0YXR1cyIsImZldGNoIiwibWV0aG9kIiwidGhlbiIsIl9nZXRSZXNwb25zZSIsInVzZXJJbmZvIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJkYXRhIiwiY2FyZElkIiwiYXZhdGFyVXJsIiwiYXZhdGFyIiwiUG9wdXBXaXRoQXBwbHkiLCJvcGVuUHJvZmlsZUJ1dHR0b24iLCJpbnB1dE5hbWUiLCJpbnB1dEluZm8iLCJvcGVuQ2FyZEJ1dHRvbiIsImZvcm1FZGl0UHJvZmlsZSIsImZvcm1BZGRDYXJkIiwiZm9ybUF2YXRhciIsImJ0bkxvYWRpbmdUZXh0IiwidmFsaWRhdG9yUHJvZmlsZUZvcm0iLCJlbmFibGVWYWxpZGF0aW9uIiwidmFsaWRhdG9yQ2FyZEZvcm0iLCJhdmF0YXJGb3JtVmFsaWRhdG9yIiwiYXBpIiwiYXV0aG9yaXphdGlvbiIsInVzZXJEYXRhIiwiaW1hZ2VQb3B1cCIsInBvcHVwV2l0aEFwcGx5Iiwic2VjdGlvbiIsImNhcmRFbGVtZW50IiwiY3JlYXRlQ2FyZCIsImNyZWF0ZU5ld0NhcmQiLCJhZGRJdGVtIiwiZ2V0VXNlckRhdGEiLCJ1c2VyIiwic2V0VXNlckluZm8iLCJzZXRVc2VyQXZhdGFyIiwiZ2V0SW5pdGlhbENhcmRzIiwiY2FyZHMiLCJyZW5kZXJJdGVtcyIsImNhdGNoIiwiZXJyIiwiY29uc29sZSIsImxvZyIsImFsZXJ0IiwicHJvZmlsZVBvcHVwIiwiYnRuRm9ybSIsImJ0bkZvcm1Jbml0aWFsVGV4dCIsInNob3dMb2FkaW5nVGV4dCIsImVkaXRVc2VyRGF0YSIsImZpbmFsbHkiLCJpbmZvT2JqZWN0IiwiZ2V0VXNlckluZm8iLCJyZXNldFZhbGlkYXRpb24iLCJvcGVuIiwiYWRkQ2FyZFBvcHVwIiwiY2FyZCIsImRlbGV0ZUxpa2UiLCJsaWtlQ2FyZCIsImFkZExpa2UiLCJoYW5kbGVEZWxldGVDb25maXJtIiwiYXZhdGFyUG9wdXAiLCJpbnB1dERhdGEiLCJlZGl0VXNlckF2YXRhciIsInRleHQiLCJzZXRFdmVudExpc3RlbmVycyJdLCJzb3VyY2VSb290IjoiIn0=