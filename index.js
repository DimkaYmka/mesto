(()=>{"use strict";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,r(o.key),o)}}function n(e,t,n){return(t=r(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(t){var n=function(t,n){if("object"!==e(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,"string");if("object"!==e(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===e(n)?n:String(n)}var o={selectorList:".elements__card",selectorTemplate:"#card",cardImgSelector:".elements__image",cardTitleSelector:".elements__title",cardDeleteBtnSelector:".elements__delete-button",toggleLikeSelector:".elements__vector",activeLikeBtnClass:"elements__vector_active",countLikes:".elements__likes-number"},i=function(){function e(t,r,o,i,u,c){var a=this,l=u.handleLikeCard,s=c.handleDeleteCard;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),n(this,"_deleteCardForSure",(function(){a._handleDeleteCard(a._cardData,a)})),n(this,"_getCardLike",(function(){a._likes.some((function(e){return e._id===a._userId}))?(a._likeButton.classList.add("elements__vector_active"),a.isLiked=!0):a._likeButton.classList.remove("elements__vector_active")})),n(this,"getLikesNumber",(function(e){a._likeNumber.innerHTML=e})),n(this,"likeCard",(function(){a._likeButton.classList.toggle("elements__vector_active")})),n(this,"_setDeleteButton",(function(){a._cardOwner===a._userId&&a._deleteButton.classList.remove("elements__delete-button_hidden")})),this._cardData=t,this._name=t.name,this._link=t.link,this._config=r,this._handleCardClick=o,this._userId=i,this._handleLikeCard=l,this._likes=t.likes,this._handleDeleteCard=s,this._cardOwner=t.owner._id}var r,o;return r=e,(o=[{key:"_getTemplate",value:function(){return document.querySelector(this._config.selectorTemplate).content.querySelector(".elements__card").cloneNode(!0)}},{key:"deleteCard",value:function(){this._element.remove()}},{key:"_toggleLike",value:function(e){e.classList.toggle(this._config.activeLikeBtnClass)}},{key:"_setEventListeners",value:function(){var e=this,t=this._element.querySelector(this._config.cardDeleteBtnSelector),n=this._element.querySelector(this._config.toggleLikeSelector);t.addEventListener("click",(function(){e._deleteCardForSure()})),this._cardImage.addEventListener("click",(function(){e._handleCardClick(e._name,e._link)})),n.addEventListener("click",(function(){e._handleLikeCard(e._cardData)}))}},{key:"createNewCard",value:function(){return this._element=this._getTemplate(),this._cardImage=this._element.querySelector(this._config.cardImgSelector),this._cardImage.src=this._link,this._cardImage.alt=" ".concat(this._link,"."),this._element.querySelector(this._config.cardTitleSelector).textContent=this._name,this._likeButton=this._element.querySelector(this._config.toggleLikeSelector),this._likeNumber=this._element.querySelector(this._config.countLikes),this._likes=this._cardData.likes,this._likeNumber.innerHTML=this._likes.length,this.isLiked=!1,this._deleteButton=this._element.querySelector(this._config.cardDeleteBtnSelector),this._setDeleteButton(),this._setEventListeners(),this._getCardLike(),this.getLikesNumber(this._likes.length),this._element}}])&&t(r.prototype,o),Object.defineProperty(r,"prototype",{writable:!1}),e}();function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==u(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==u(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===u(o)?o:String(o)),r)}var o}var a={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__save-btn",inactiveButtonClass:"popup__save-btn_inactive",inputErrorClass:"popup__input_type_error",errorClass:"popup__input-error_active"},l=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._formSetting=t,this._formElement=n,this._inputList=Array.from(this._formElement.querySelectorAll(this._formSetting.inputSelector)),this._submitButton=this._formElement.querySelector(this._formSetting.submitButtonSelector)}var t,n;return t=e,(n=[{key:"_showInputError",value:function(e,t){var n=this._formElement.querySelector(".".concat(e.id,"-error"));e.classList.add(this._formSetting.inputErrorClass),n.textContent=t,n.classList.add(this._formSetting.errorClass)}},{key:"_hideInputError",value:function(e){var t=this._formElement.querySelector(".".concat(e.id,"-error"));t.textContent="",e.classList.remove(this._formSetting.inputErrorClass),t.classList.remove(this._formSetting.errorClass)}},{key:"_checkInputValidity",value:function(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}},{key:"resetValidation",value:function(){var e=this;this._toggleButtonState(),this._inputList.forEach((function(t){e._hideInputError(t)}))}},{key:"_toggleButtonState",value:function(){this._hasInvalidInput()?(this._submitButton.classList.add(this._formSetting.inactiveButtonClass),this._submitButton.disabled=!0):(this._submitButton.classList.remove(this._formSetting.inactiveButtonClass),this._submitButton.disabled=!1)}},{key:"_hasInvalidInput",value:function(){return this._inputList.some((function(e){return!e.validity.valid}))}},{key:"_setEventListeners",value:function(){var e=this;this._toggleButtonState(),this._inputList.forEach((function(t){t.addEventListener("input",(function(){e._checkInputValidity(t),e._toggleButtonState()}))}))}},{key:"enableValidation",value:function(){this._formElement.addEventListener("submit",(function(e){e.preventDefault()})),this._setEventListeners()}}])&&c(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==s(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==s(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===s(o)?o:String(o)),r)}var o}var p=function(){function e(t,n){var r=t.items,o=t.renderer;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._renderItems=r,this._renderer=o,this._container=document.querySelector(n)}var t,n;return t=e,(n=[{key:"renderItems",value:function(e){var t=this;e.forEach((function(e){return t._renderer(e)}))}},{key:"addItem",value:function(e){this._container.prepend(e)}}])&&f(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function y(e){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},y(e)}function h(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==y(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==y(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===y(o)?o:String(o)),r)}var o}var d=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._popup=document.querySelector(t),this._handleEscClose=this._handleEscClose.bind(this)}var t,n;return t=e,(n=[{key:"open",value:function(){this._popup.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEscClose)}},{key:"close",value:function(){this._popup.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClose)}},{key:"_handleEscClose",value:function(e){"Escape"===e.key&&this.close()}},{key:"setEventListeners",value:function(){var e=this;this._popup.addEventListener("mousedown",(function(t){t.target.classList.contains("popup_opened")&&e.close(),t.target.classList.contains("popup__close-popup")&&e.close()}))}}])&&h(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function m(e){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},m(e)}function _(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==m(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==m(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===m(o)?o:String(o)),r)}var o}function v(){return v="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=g(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},v.apply(this,arguments)}function b(e,t){return b=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},b(e,t)}function g(e){return g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},g(e)}var S=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&b(e,t)}(u,e);var t,n,r,o,i=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=g(r);if(o){var n=g(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===m(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function u(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(t=i.call(this,e))._popupBigImage=t._popup.querySelector(".popup__big-image"),t._popupTitle=t._popup.querySelector(".popup__big-title"),t}return t=u,(n=[{key:"open",value:function(e,t){v(g(u.prototype),"open",this).call(this),this._popupBigImage.src=t,this._popupBigImage.alt=e,this._popupTitle.textContent=e}}])&&_(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),u}(d);function k(e){return k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},k(e)}function w(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,C(r.key),r)}}function E(e,t){return E=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},E(e,t)}function L(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function O(){return O="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=P(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},O.apply(this,arguments)}function P(e){return P=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},P(e)}function j(e,t,n){return(t=C(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function C(e){var t=function(e,t){if("object"!==k(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==k(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===k(t)?t:String(t)}var T=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&E(e,t)}(u,e);var t,n,r,o,i=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=P(r);if(o){var n=P(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===k(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return L(e)}(this,e)});function u(e,t,n){var r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),j(L(o=i.call(this,e)),"_getInputValues",(function(){var e={};return o._inputList.forEach((function(t){e[t.name]=t.value})),e})),j(L(o),"setEventListeners",(function(){O((r=L(o),P(u.prototype)),"setEventListeners",r).call(r),o._form.addEventListener("submit",(function(e){e.preventDefault(),o._handleProfileFormSubmit(o._getInputValues(),o._btnForm),o.close()}))})),o._handleProfileFormSubmit=t,o._form=o._popup.querySelector(".popup__form"),o._inputList=o._form.querySelectorAll(".popup__input"),o._btnForm=o._form.querySelector(n),o}return t=u,(n=[{key:"getInputValues",value:function(){return this._inputFormValues}},{key:"close",value:function(){O(P(u.prototype),"close",this).call(this),this._form.reset()}}])&&w(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),u}(d);function I(e){return I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},I(e)}function B(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==I(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==I(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===I(o)?o:String(o)),r)}var o}var q=function(){function e(t){var n=t.profileNameSelector,r=t.profileInfoSelector,o=t.avatarSelector;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._name=document.querySelector(n),this._info=document.querySelector(r),this._userAvatar=document.querySelector(o)}var t,n;return t=e,(n=[{key:"getUserInfo",value:function(){return{name:this._name.textContent,info:this._info.textContent}}},{key:"setUserInfo",value:function(e){this._name.textContent=e.name,this._info.textContent=e.about}},{key:"setUserAvatar",value:function(e){var t=e.link;this._userAvatar.src=t}}])&&B(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function R(e){return R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},R(e)}function D(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==R(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==R(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===R(o)?o:String(o)),r)}var o}var U=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._baseUrl=t.baseUrl,this._headers=t.headers}var t,n;return t=e,(n=[{key:"_getResponse",value:function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}},{key:"getInitialCards",value:function(){return fetch("".concat(this._baseUrl,"/cards"),{method:"GET",headers:this._headers}).then(this._getResponse)}},{key:"getUserData",value:function(){return fetch("".concat(this._baseUrl,"/users/me"),{method:"GET",headers:this._headers}).then(this._getResponse)}},{key:"editUserData",value:function(e){return fetch("".concat(this._baseUrl,"/users/me"),{method:"PATCH",headers:this._headers,body:JSON.stringify(e)}).then(this._getResponse)}},{key:"createCard",value:function(e){return fetch("".concat(this._baseUrl,"/cards"),{method:"POST",headers:this._headers,body:JSON.stringify(e)}).then(this._getResponse)}},{key:"addLike",value:function(e){return fetch("".concat(this._baseUrl,"/cards/").concat(e._id,"/likes"),{method:"PUT",headers:this._headers,body:JSON.stringify(e)}).then(this._getResponse)}},{key:"deleteLike",value:function(e){return fetch("".concat(this._baseUrl,"/cards/").concat(e,"/likes"),{method:"DELETE",headers:this._headers}).then(this._getResponse)}},{key:"editUserAvatar",value:function(e){return fetch("".concat(this._baseUrl,"/users/me/avatar"),{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})}).then(this._getResponse)}},{key:"deleteCard",value:function(e){return fetch("".concat(this._baseUrl,"/cards/").concat(e),{method:"DELETE",headers:this._headers}).then(this._getResponse)}}])&&D(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function x(e){return x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},x(e)}function N(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,J(r.key),r)}}function V(e,t){return V=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},V(e,t)}function A(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function F(){return F="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=H(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},F.apply(this,arguments)}function H(e){return H=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},H(e)}function J(e){var t=function(e,t){if("object"!==x(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==x(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===x(t)?t:String(t)}var M=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&V(e,t)}(u,e);var t,n,r,o,i=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=H(r);if(o){var n=H(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===x(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return A(e)}(this,e)});function u(e){var t,n,r,o,c;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),r=A(n=i.call(this,e)),c=function(){F((t=A(n),H(u.prototype)),"setEventListeners",t).call(t),n._form.addEventListener("submit",(function(e){e.preventDefault(),n._handleProfileFormSubmit(),n.close()}))},(o=J(o="setEventListeners"))in r?Object.defineProperty(r,o,{value:c,enumerable:!0,configurable:!0,writable:!0}):r[o]=c,n._form=n._popup.querySelector(".popup__form"),n._submitButton=n._popup.querySelector(".popup__save-btn"),n}return t=u,(n=[{key:"handleDeleteConfirm",value:function(e){var t=e.handleProfileFormSubmit;this._handleProfileFormSubmit=t}}])&&N(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),u}(d),G=document.querySelector(".profile__edit-button"),z=document.querySelector("#input-name"),K=document.querySelector("#input-info"),Q=document.querySelector(".profile__add-button"),W=(document.querySelector(".popup__big-image"),document.querySelector(".popup__big-title"),document.querySelector(".popup_image"),document.querySelector(".popup__form-profile")),X=document.querySelector(".popup__form-card"),Y=document.querySelector(".popup__form-avatar"),Z=".popup__save-btn",$="Сохранение...",ee=new l(a,W);ee.enableValidation();var te=new l(a,X);te.enableValidation();var ne=new l(a,Y);ne.enableValidation();var re,oe=new U({baseUrl:"https://mesto.nomoreparties.co/v1/cohort-62",headers:{authorization:"bc440bce-88d2-40de-813f-9186a5211a71","Content-Type":"application/json"}}),ie=new q({profileNameSelector:".profile__name",profileInfoSelector:".profile__text",avatarSelector:".profile__avatar"}),ue=new S(".popup_image"),ce=new M(".popup_delete"),ae=new p({renderer:function(e){var t=fe(e).createNewCard();ae.addItem(t)}},".elements__list");oe.getUserData().then((function(e){ie.setUserInfo({name:e.name,about:e.about}),ie.setUserAvatar({link:e.avatar}),re=e._id,oe.getInitialCards().then((function(e){ae.renderItems(e)})).catch((function(e){console.log(e)}))})).catch((function(e){return alert(e)}));var le=new T(".popup_profile",(function(e,t){var n=t.textContent;ye(t,$),oe.editUserData(e).then((function(e){ie.setUserInfo(e)})).then((function(){le.close()})).catch((function(t){alert(t),ie.setUserInfo(e)})).finally((function(){ye(t,n)}))}),Z);G.addEventListener("click",(function(){var e=ie.getUserInfo();z.value=e.name,K.value=e.info,ee.resetValidation(),le.open()}));var se=new T(".popup_card",(function(e,t){var n=t.textContent;ye(t,$),oe.createCard(e).then((function(e){fe(e),ae.addItem(fe(e).createNewCard()),se.close()})).catch((function(e){return alert(e)})).finally((function(){ye(t,n)}))}),Z);function fe(e){var t=new i(e,o,he,re,{handleLikeCard:function(e){t.isLiked?oe.deleteLike(e._id).then((function(e){t.isLiked=!1,t.getLikesNumber(e.likes.length),t.likeCard()})).catch((function(e){console.log(e)})):oe.addLike(e).then((function(e){t.isLiked=!0,t.getLikesNumber(e.likes.length),t.likeCard()})).catch((function(e){console.log(e)}))}},{handleDeleteCard:function(e,t){ce.open(),ce.handleDeleteConfirm({handleProfileFormSubmit:function(){oe.deleteCard(e._id).then((function(){t.deleteCard()})).then((function(){ce.close()})).catch((function(e){console.log(e)}))}})}});return t}Q.addEventListener("click",(function(){se.open(),te.resetValidation()}));var pe=new T(".popup_avatar",(function(e,t){var n=t.textContent;ye(t,$),oe.editUserAvatar(e.link).then((function(e){ie.setUserAvatar({link:e.avatar}),pe.close()})).catch((function(e){console.log(e)})).finally((function(){ye(t,n)}))}),Z);function ye(e,t){e.textContent=t}function he(e,t){ue.open(e,t)}document.querySelector(".profile__avatar-button").addEventListener("click",(function(){ne.resetValidation(),pe.open()})),le.setEventListeners(),se.setEventListeners(),ue.setEventListeners(),pe.setEventListeners(),ce.setEventListeners()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RCxHQUFZOUcsT0FDZCxJQUNDeUYsT0FBTSxTQUFDQyxHQUNOQyxRQUFRQyxJQUFJRixFQUNkLElBQ0NTLFNBQVEsV0FDUEYsR0FBZ0JGLEVBQVNDLEVBQzNCLEdBQ0YsR0FBR2pGLEdBVVAsU0FBU2tGLEdBQWdCRixFQUFTa0IsR0FDaENsQixFQUFRcEosWUFBY3NLLENBQ3hCLENBRUEsU0FBUzVOLEdBQWdCNkIsRUFBTUUsR0FDN0J1SixHQUFXNEIsS0FBS3JMLEVBQU1FLEVBQ3hCLENBWmVRLFNBQVNDLGNBQWMsMkJBQy9CTyxpQkFBaUIsU0FBUyxXQUMvQm1JLEdBQW9CK0Isa0JBQ3BCUSxHQUFZUCxNQUNkLElBWUFULEdBQWFvQixvQkFDYlYsR0FBYVUsb0JBQ2J2QyxHQUFXdUMsb0JBQ1hKLEdBQVlJLG9CQUNadEMsR0FBZXNDLG1CIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbWVzdG8tbWFpbi04Ly4vc3JjL3NjcmlwdHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly9tZXN0by1tYWluLTgvLi9zcmMvc2NyaXB0cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL21lc3RvLW1haW4tOC8uL3NyYy9zY3JpcHRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vbWVzdG8tbWFpbi04Ly4vc3JjL3NjcmlwdHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vbWVzdG8tbWFpbi04Ly4vc3JjL3NjcmlwdHMvUG9wdXBXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vbWVzdG8tbWFpbi04Ly4vc3JjL3NjcmlwdHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly9tZXN0by1tYWluLTgvLi9zcmMvc2NyaXB0cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly9tZXN0by1tYWluLTgvLi9zcmMvc2NyaXB0cy9BcGkuanMiLCJ3ZWJwYWNrOi8vbWVzdG8tbWFpbi04Ly4vc3JjL3NjcmlwdHMvUG9wdXBXaXRoQXBwbHkuanMiLCJ3ZWJwYWNrOi8vbWVzdG8tbWFpbi04Ly4vc3JjL3BhZ2VzL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbIlxuXG5cbi8v0KHQtdC70LXQutGC0L7RgCDQutC70LDRgdGB0LBcbmNvbnN0IGNvbmZpZyA9IHtcbiAgc2VsZWN0b3JMaXN0OiAnLmVsZW1lbnRzX19jYXJkJyxcbiAgc2VsZWN0b3JUZW1wbGF0ZTogJyNjYXJkJyxcbiAgY2FyZEltZ1NlbGVjdG9yOiAnLmVsZW1lbnRzX19pbWFnZScsXG4gIGNhcmRUaXRsZVNlbGVjdG9yOiAnLmVsZW1lbnRzX190aXRsZScsXG4gIGNhcmREZWxldGVCdG5TZWxlY3RvcjogJy5lbGVtZW50c19fZGVsZXRlLWJ1dHRvbicsXG4gIHRvZ2dsZUxpa2VTZWxlY3RvcjogJy5lbGVtZW50c19fdmVjdG9yJyxcbiAgYWN0aXZlTGlrZUJ0bkNsYXNzOiAnZWxlbWVudHNfX3ZlY3Rvcl9hY3RpdmUnLFxuICBjb3VudExpa2VzOiAnLmVsZW1lbnRzX19saWtlcy1udW1iZXInXG59XG4vL9Ca0LvQsNGB0YFcbmNsYXNzIENhcmQge1xuICBjb25zdHJ1Y3RvcihjYXJkRGF0YSwgY29uZmlnLCBoYW5kbGVDYXJkQ2xpY2ssIHVzZXJJZCwge2hhbmRsZUxpa2VDYXJkfSwge2hhbmRsZURlbGV0ZUNhcmR9KSB7XG4gICAgdGhpcy5fY2FyZERhdGEgPSBjYXJkRGF0YTtcbiAgICB0aGlzLl9uYW1lID0gY2FyZERhdGEubmFtZTtcbiAgICB0aGlzLl9saW5rID0gY2FyZERhdGEubGluaztcbiAgICB0aGlzLl9jb25maWcgPSBjb25maWc7XG4gICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrID0gaGFuZGxlQ2FyZENsaWNrO1xuICAgIFxuICAgIHRoaXMuX3VzZXJJZCA9IHVzZXJJZDtcbiAgICB0aGlzLl9oYW5kbGVMaWtlQ2FyZCA9IGhhbmRsZUxpa2VDYXJkO1xuICAgIHRoaXMuX2xpa2VzID0gY2FyZERhdGEubGlrZXNcbiAgICB0aGlzLl9oYW5kbGVEZWxldGVDYXJkID0gaGFuZGxlRGVsZXRlQ2FyZDtcbiAgICB0aGlzLl9jYXJkT3duZXIgPSBjYXJkRGF0YS5vd25lci5faWQ7XG4gIH1cblxuXG4gIC8v0JTQvtCx0LDQstC70LXQvdC40LUg0YHQstC+0LXQuSDQutCw0YDRgtC+0YfQutC4XG4gIF9nZXRUZW1wbGF0ZSgpIHtcbiAgXG4gICAgY29uc3QgbmV3Q2FyZCA9IGRvY3VtZW50XG4gICAgICAucXVlcnlTZWxlY3Rvcih0aGlzLl9jb25maWcuc2VsZWN0b3JUZW1wbGF0ZSlcbiAgICAgIC5jb250ZW50XG4gICAgICAucXVlcnlTZWxlY3RvcignLmVsZW1lbnRzX19jYXJkJylcbiAgICAgIC5jbG9uZU5vZGUodHJ1ZSk7XG5cbiAgICByZXR1cm4gbmV3Q2FyZDtcbiAgfVxuXG4gIF9kZWxldGVDYXJkRm9yU3VyZSA9ICgpID0+IHtcbiAgIHRoaXMuX2hhbmRsZURlbGV0ZUNhcmQodGhpcy5fY2FyZERhdGEsIHRoaXMpXG4gIH1cblxuICAvL9GD0LTQsNC70LXQvdC4ZSDQutCw0YDRgtC+0YfQutC4IFxuICBkZWxldGVDYXJkKCkgeyAgXG4gICAgIHRoaXMuX2VsZW1lbnQucmVtb3ZlKClcbiAgfVxuXG4gIC8v0LTQvtCx0LDQstC70LXQvdC40LUg0LvQsNC50LrQsFxuICBfdG9nZ2xlTGlrZShlbGVtZW50c0xpa2UpIHtcbiAgICBlbGVtZW50c0xpa2UuY2xhc3NMaXN0LnRvZ2dsZSh0aGlzLl9jb25maWcuYWN0aXZlTGlrZUJ0bkNsYXNzKVxuICB9XG5cbiAgLy8g0YHQu9GD0YjQsNGC0LXQu9C4INC90LAg0LTQvtCx0LDQstC70LXQvdC40LUg0LvQsNC50LrQsCwg0YPQtNCw0LvQtdC90LjQtSDQutCw0YDRgtC+0YfQutC4INC4INC+0YLQutGA0YvRgtC40LUg0YTQvtGC0L5cbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIGNvbnN0IGRlbGV0ZUNhcmQgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IodGhpcy5fY29uZmlnLmNhcmREZWxldGVCdG5TZWxlY3Rvcik7XG4gICAgY29uc3QgZWxlbWVudHNMaWtlID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKHRoaXMuX2NvbmZpZy50b2dnbGVMaWtlU2VsZWN0b3IpO1xuXG4gICAgZGVsZXRlQ2FyZC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgIHRoaXMuX2RlbGV0ZUNhcmRGb3JTdXJlKClcbiAgICB9KVxuXG4gICAgdGhpcy5fY2FyZEltYWdlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrKHRoaXMuX25hbWUsIHRoaXMuX2xpbmspXG4gICAgfSlcblxuICAgIGVsZW1lbnRzTGlrZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgIHRoaXMuX2hhbmRsZUxpa2VDYXJkKHRoaXMuX2NhcmREYXRhKTtcbiAgICB9KVxuICB9XG5cbiAgLy/QlNC+0LHQsNCy0LvQtdC90LjQtSDRgdCy0L7QtdC5INC60LDRgNGC0L7Rh9C60LhcbiAgY3JlYXRlTmV3Q2FyZCgpIHtcbiAgICB0aGlzLl9lbGVtZW50ID0gdGhpcy5fZ2V0VGVtcGxhdGUoKTtcbiAgICB0aGlzLl9jYXJkSW1hZ2UgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IodGhpcy5fY29uZmlnLmNhcmRJbWdTZWxlY3Rvcik7XG5cbiAgICB0aGlzLl9jYXJkSW1hZ2Uuc3JjID0gdGhpcy5fbGluaztcbiAgICB0aGlzLl9jYXJkSW1hZ2UuYWx0ID0gYCAke3RoaXMuX2xpbmt9LmA7XG4gICAgdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKHRoaXMuX2NvbmZpZy5jYXJkVGl0bGVTZWxlY3RvcikudGV4dENvbnRlbnQgPSB0aGlzLl9uYW1lO1xuXG4gICAgdGhpcy5fbGlrZUJ1dHRvbiA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLl9jb25maWcudG9nZ2xlTGlrZVNlbGVjdG9yKTtcbiAgICB0aGlzLl9saWtlTnVtYmVyID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKHRoaXMuX2NvbmZpZy5jb3VudExpa2VzKTtcblxuICAgIHRoaXMuX2xpa2VzID0gdGhpcy5fY2FyZERhdGEubGlrZXM7XG4gICAgdGhpcy5fbGlrZU51bWJlci5pbm5lckhUTUwgPSB0aGlzLl9saWtlcy5sZW5ndGg7XG4gICBcbiAgICB0aGlzLmlzTGlrZWQgPSBmYWxzZTtcbiAgIFxuICAgIHRoaXMuX2RlbGV0ZUJ1dHRvbiA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLl9jb25maWcuY2FyZERlbGV0ZUJ0blNlbGVjdG9yKTsgXG4gICAgdGhpcy5fc2V0RGVsZXRlQnV0dG9uKCk7XG5cbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xuXG4gICAgdGhpcy5fZ2V0Q2FyZExpa2UoKTtcbiAgICB0aGlzLmdldExpa2VzTnVtYmVyKHRoaXMuX2xpa2VzLmxlbmd0aCk7XG4gICAgcmV0dXJuIHRoaXMuX2VsZW1lbnQ7XG5cbiAgICBcbiAgfVxuXG5cbiAgX2dldENhcmRMaWtlID0gKCkgPT4ge1xuICAgIGlmICh0aGlzLl9saWtlcy5zb21lKGxpa2VyID0+IGxpa2VyLl9pZCA9PT0gdGhpcy5fdXNlcklkKSkge1xuICAgICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QuYWRkKCdlbGVtZW50c19fdmVjdG9yX2FjdGl2ZScpO1xuICAgICAgdGhpcy5pc0xpa2VkID0gdHJ1ZTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoJ2VsZW1lbnRzX192ZWN0b3JfYWN0aXZlJyk7XG4gICAgfVxuICB9XG5cbiAgZ2V0TGlrZXNOdW1iZXIgPSAobGlrZXNOdW1iZXIpID0+IHtcbiAgICB0aGlzLl9saWtlTnVtYmVyLmlubmVySFRNTCA9IGxpa2VzTnVtYmVyO1xuICB9XG5cbiAgbGlrZUNhcmQgPSAoKSA9PiB7XG4gICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QudG9nZ2xlKCdlbGVtZW50c19fdmVjdG9yX2FjdGl2ZScpO1xuICB9XG4gIF9zZXREZWxldGVCdXR0b24gPSAoKSA9PiB7XG4gICAgaWYgKHRoaXMuX2NhcmRPd25lciA9PT0gdGhpcy5fdXNlcklkKSB7XG4gICAgICB0aGlzLl9kZWxldGVCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSgnZWxlbWVudHNfX2RlbGV0ZS1idXR0b25faGlkZGVuJyk7XG4gICAgfVxuICB9XG5cbn07XG5cbmV4cG9ydCB7IENhcmQsIGNvbmZpZ30iLCJcblxuY29uc3QgZm9ybVNldHRpbmcgPSB7XG4gIGZvcm1TZWxlY3RvcjogJy5wb3B1cF9fZm9ybScsXG4gIGlucHV0U2VsZWN0b3I6ICcucG9wdXBfX2lucHV0JyxcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6ICcucG9wdXBfX3NhdmUtYnRuJyxcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogJ3BvcHVwX19zYXZlLWJ0bl9pbmFjdGl2ZScsXG4gIGlucHV0RXJyb3JDbGFzczogJ3BvcHVwX19pbnB1dF90eXBlX2Vycm9yJyxcbiAgZXJyb3JDbGFzczogJ3BvcHVwX19pbnB1dC1lcnJvcl9hY3RpdmUnXG59O1xuXG5jbGFzcyBGb3JtVmFsaWRhdG9yIHtcbiAgY29uc3RydWN0b3IoZm9ybVNldHRpbmcsIGZvcm1FbGVtZW50KSB7XG4gICAgdGhpcy5fZm9ybVNldHRpbmcgPSBmb3JtU2V0dGluZztcbiAgICB0aGlzLl9mb3JtRWxlbWVudCA9IGZvcm1FbGVtZW50XG5cbiAgICB0aGlzLl9pbnB1dExpc3QgPSBBcnJheS5mcm9tKHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5fZm9ybVNldHRpbmcuaW5wdXRTZWxlY3RvcikpO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IodGhpcy5fZm9ybVNldHRpbmcuc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xuICB9XG5cbiAgLy9cbiAgX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCwgZXJyb3JNZXNzYWdlKSB7XG4gICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihgLiR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmApO1xuICAgIC8vIGNvbnNvbGUubG9nKGVycm9yRWxlbWVudCk7XG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fZm9ybVNldHRpbmcuaW5wdXRFcnJvckNsYXNzKTtcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBlcnJvck1lc3NhZ2U7XG4gICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fZm9ybVNldHRpbmcuZXJyb3JDbGFzcyk7XG4gIH1cbiAgLy9cbiAgX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCkge1xuICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoYC4ke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgKTtcbiAgICAvLyBjb25zb2xlLmxvZyhlcnJvckVsZW1lbnQpO1xuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9ICcnO1xuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2Zvcm1TZXR0aW5nLmlucHV0RXJyb3JDbGFzcyk7XG4gICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fZm9ybVNldHRpbmcuZXJyb3JDbGFzcyk7XG5cbiAgfVxuICAvL1xuICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCkge1xuICAgIGlmICghaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7XG4gICAgICB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQsIGlucHV0RWxlbWVudC52YWxpZGF0aW9uTWVzc2FnZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XG4gICAgfVxuICB9XG4gIC8vXG5cbiAgcmVzZXRWYWxpZGF0aW9uKCkge1xuICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XG5cbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpXG4gICAgfSk7XG5cbiAgfVxuXG4gIF90b2dnbGVCdXR0b25TdGF0ZSgpIHtcbiAgICBpZiAodGhpcy5faGFzSW52YWxpZElucHV0KCkpIHtcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QuYWRkKHRoaXMuX2Zvcm1TZXR0aW5nLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gdHJ1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fZm9ybVNldHRpbmcuaW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSBmYWxzZTtcbiAgICB9XG4gIH1cbiAgLy9cbiAgX2hhc0ludmFsaWRJbnB1dCgpIHtcbiAgXG4gICAgcmV0dXJuIHRoaXMuX2lucHV0TGlzdC5zb21lKChpbnB1dEVsZW1lbnQpID0+IHtcbiAgICAgIHJldHVybiAhaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkO1xuICAgIH0pO1xuICB9XG4gIC8vXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xuXG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xuICAgICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgKCkgPT4ge1xuICAgICAgICB0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KTtcbiAgICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG4gIC8vXG4gIGVuYWJsZVZhbGlkYXRpb24oKSB7XG4gICAgdGhpcy5fZm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgKGV2dCkgPT4ge1xuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgfSk7XG5cbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xuICB9XG59XG5cbmV4cG9ydCB7IEZvcm1WYWxpZGF0b3IsIGZvcm1TZXR0aW5nIH0iLCJleHBvcnQgY2xhc3MgU2VjdGlvbntcbiAgICBjb25zdHJ1Y3Rvcih7aXRlbXMsIHJlbmRlcmVyfSwgc2VsZWN0b3IpIHtcbiAgICAgIHRoaXMuX3JlbmRlckl0ZW1zID0gaXRlbXM7IFxuICAgICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcbiAgICAgIHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Ioc2VsZWN0b3IpO1xuXG4gICAgfVxuXG4gICAgcmVuZGVySXRlbXMoaXRlbXMpIHtcbiAgICAgICAgaXRlbXMuZm9yRWFjaCgoaXRlbSk9PnRoaXMuX3JlbmRlcmVyKGl0ZW0pKVxuICAgICAgfVxuXG4gICAgICBhZGRJdGVtKGl0ZW0pIHtcbiAgICAgICAgdGhpcy5fY29udGFpbmVyLnByZXBlbmQoaXRlbSlcbiAgICAgIH1cbiAgICB9XG4iLCJcbmV4cG9ydCBjbGFzcyBQb3B1cCB7XG4gICAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xuICAgICAgICB0aGlzLl9wb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XG4gICAgICAgIHRoaXMuX2hhbmRsZUVzY0Nsb3NlID0gdGhpcy5faGFuZGxlRXNjQ2xvc2UuYmluZCh0aGlzKVxuICAgIH1cblxuXG5vcGVuKCkge1xuICAgIHRoaXMuX3BvcHVwLmNsYXNzTGlzdC5hZGQoJ3BvcHVwX29wZW5lZCcpO1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7IFxufVxuXG5jbG9zZSgpIHtcbiAgICB0aGlzLl9wb3B1cC5jbGFzc0xpc3QucmVtb3ZlKCdwb3B1cF9vcGVuZWQnKTtcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5faGFuZGxlRXNjQ2xvc2UpXG4gfVxuXG5faGFuZGxlRXNjQ2xvc2UoZXZ0KSB7XG4gICAgaWYgKGV2dC5rZXkgPT09IFwiRXNjYXBlXCIpIHtcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgfTtcbn1cblxuc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fcG9wdXAuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgKGV2dCkgPT4ge1xuICAgICAgICBpZiAoZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ3BvcHVwX29wZW5lZCcpKSB7XG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdwb3B1cF9fY2xvc2UtcG9wdXAnKSkge1xuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICB9XG4gICAgfSlcbiAgfVxuXG59XG5cblxuXG5cblxuXG4iLCJpbXBvcnQge1BvcHVwfSBmcm9tICcuL1BvcHVwLmpzJ1xuXG5cbmV4cG9ydCBjbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwe1xuICAgIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcbiAgICAgICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XG4gICAgICAgIHRoaXMuX3BvcHVwQmlnSW1hZ2UgPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2JpZy1pbWFnZScpO1xuICAgICAgICB0aGlzLl9wb3B1cFRpdGxlID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcignLnBvcHVwX19iaWctdGl0bGUnKTtcbiAgICB9XG5cblxuICAgIG9wZW4obmFtZSwgbGluaykge1xuICAgICAgICBzdXBlci5vcGVuKCk7XG4gICAgICAgIHRoaXMuX3BvcHVwQmlnSW1hZ2Uuc3JjID0gbGluaztcbiAgICAgICAgdGhpcy5fcG9wdXBCaWdJbWFnZS5hbHQgPSBuYW1lO1xuICAgICAgICB0aGlzLl9wb3B1cFRpdGxlLnRleHRDb250ZW50ID0gIG5hbWU7XG5cbiAgICAgIH07XG4gICAgICBcbiAgICAgIFxufSIsImltcG9ydCB7IFBvcHVwIH0gZnJvbSBcIi4vUG9wdXAuanNcIjtcblxuZXhwb3J0IGNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IsIGhhbmRsZVByb2ZpbGVGb3JtU3VibWl0LCBidG5Gb3JtU2VsZWN0b3IpIHtcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcbiAgICB0aGlzLl9oYW5kbGVQcm9maWxlRm9ybVN1Ym1pdCA9IGhhbmRsZVByb2ZpbGVGb3JtU3VibWl0O1xuICAgIHRoaXMuX2Zvcm0gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2Zvcm0nKTtcbiAgICB0aGlzLl9pbnB1dExpc3QgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoJy5wb3B1cF9faW5wdXQnKTtcbiAgICB0aGlzLl9idG5Gb3JtID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKGJ0bkZvcm1TZWxlY3RvcilcbiAgfVxuXG5cblxuICBfZ2V0SW5wdXRWYWx1ZXMgPSAoKSA9PiB7XG4gICAgY29uc3QgaW5wdXRWYWx1ZXMgPSB7fTtcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaChpbnB1dEl0ZW0gPT4ge1xuICAgICAgaW5wdXRWYWx1ZXNbaW5wdXRJdGVtLm5hbWVdID0gaW5wdXRJdGVtLnZhbHVlO1xuICAgIH0pXG4gICAgcmV0dXJuIGlucHV0VmFsdWVzO1xuICB9XG5cbiAgZ2V0SW5wdXRWYWx1ZXMoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2lucHV0Rm9ybVZhbHVlcztcbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzID0gKCkgPT4ge1xuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbiAgICB0aGlzLl9mb3JtLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIChlKSA9PiB7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB0aGlzLl9oYW5kbGVQcm9maWxlRm9ybVN1Ym1pdCh0aGlzLl9nZXRJbnB1dFZhbHVlcygpLCB0aGlzLl9idG5Gb3JtKTtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9KTtcbiAgfVxuXG4gIGNsb3NlKCkge1xuICAgIHN1cGVyLmNsb3NlKCk7XG4gICAgdGhpcy5fZm9ybS5yZXNldCgpO1xuICB9XG59IiwiXG5leHBvcnQgY2xhc3MgVXNlckluZm8ge1xuICAgIFxuICAgIGNvbnN0cnVjdG9yKHsgcHJvZmlsZU5hbWVTZWxlY3RvciwgcHJvZmlsZUluZm9TZWxlY3RvciwgIGF2YXRhclNlbGVjdG9yIH0pIHtcbiAgICAgIHRoaXMuX25hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHByb2ZpbGVOYW1lU2VsZWN0b3IpO1xuICAgICAgdGhpcy5faW5mbyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocHJvZmlsZUluZm9TZWxlY3Rvcik7XG4gICAgICB0aGlzLl91c2VyQXZhdGFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihhdmF0YXJTZWxlY3RvcilcbiAgICB9XG4gIFxuICAgIFxuICAgIGdldFVzZXJJbmZvKCkge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgbmFtZTogdGhpcy5fbmFtZS50ZXh0Q29udGVudCxcbiAgICAgICAgaW5mbzogdGhpcy5faW5mby50ZXh0Q29udGVudCxcbiAgICAgIH07XG4gICAgfVxuICBcbiAgICBzZXRVc2VySW5mbyhpbnB1dFZhbHVlcykge1xuICAgICAgdGhpcy5fbmFtZS50ZXh0Q29udGVudCA9IGlucHV0VmFsdWVzLm5hbWU7XG4gICAgICB0aGlzLl9pbmZvLnRleHRDb250ZW50ID0gaW5wdXRWYWx1ZXMuYWJvdXQ7XG4gICAgfVxuXG4gICAgc2V0VXNlckF2YXRhcih7bGlua30pIHtcbiAgICAgIHRoaXMuX3VzZXJBdmF0YXIuc3JjID0gbGluaztcbiAgICB9XG4gIH1cblxuIiwiZXhwb3J0IGNsYXNzIEFwaSB7XG4gIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHtcbiAgICB0aGlzLl9iYXNlVXJsID0gb3B0aW9ucy5iYXNlVXJsO1xuICAgIHRoaXMuX2hlYWRlcnMgPSBvcHRpb25zLmhlYWRlcnM7XG4gIH1cblxuXG4gIF9nZXRSZXNwb25zZShyZXMpIHtcbiAgICBpZiAocmVzLm9rKSB7XG4gICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICB9XG4gICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGDQntGI0LjQsdC60LA6ICR7cmVzLnN0YXR1c31gKTtcbn1cblxuICBnZXRJbml0aWFsQ2FyZHMoKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xuICAgICAgbWV0aG9kOiAnR0VUJyxcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnNcbiAgICB9KVxuICAgICAgLnRoZW4odGhpcy5fZ2V0UmVzcG9uc2UpXG4gIH1cblxuXG4gICAgLy8gXG4gICAgZ2V0VXNlckRhdGEoKSB7XG4gICAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XG4gICAgICAgICAgbWV0aG9kOiAnR0VUJyxcbiAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgICB9KVxuICAgICAgICAudGhlbih0aGlzLl9nZXRSZXNwb25zZSlcbiAgICB9XG4gIFxuICAgIC8vIFxuICAgIGVkaXRVc2VyRGF0YSh1c2VySW5mbykge1xuICAgICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xuICAgICAgICAgIG1ldGhvZDogJ1BBVENIJyxcbiAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHVzZXJJbmZvKVxuICAgICAgICB9KVxuICAgICAgICAudGhlbih0aGlzLl9nZXRSZXNwb25zZSlcbiAgICB9XG4vLyBcbiAgICBjcmVhdGVDYXJkKGRhdGEpIHtcbiAgICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2Ase1xuICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoZGF0YSlcbiAgICAgIH0pXG4gICAgICAudGhlbih0aGlzLl9nZXRSZXNwb25zZSk7XG4gICAgfVxuICAgIGFkZExpa2UoZGF0YSkge1xuICAgICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7ZGF0YS5faWR9L2xpa2VzYCwge1xuICAgICAgICBtZXRob2Q6ICdQVVQnLFxuICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShkYXRhKVxuICAgICAgfSlcbiAgICAgIC50aGVuKHRoaXMuX2dldFJlc3BvbnNlKTtcbiAgICB9XG4gIFxuICAgIGRlbGV0ZUxpa2UoY2FyZElkKSB7XG4gICAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9L2xpa2VzYCwge1xuICAgICAgICBtZXRob2Q6ICdERUxFVEUnLFxuICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzXG4gICAgICB9KVxuICAgICAgLnRoZW4odGhpcy5fZ2V0UmVzcG9uc2UpO1xuICAgIH1cblxuICAgIGVkaXRVc2VyQXZhdGFyKGF2YXRhclVybCkge1xuICAgICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lL2F2YXRhcmAsIHtcbiAgICAgICAgICBtZXRob2Q6ICdQQVRDSCcsXG4gICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICBhdmF0YXIgOiBhdmF0YXJVcmxcbiAgICAgICAgICB9KVxuICAgICAgICB9KVxuICAgICAgICAudGhlbih0aGlzLl9nZXRSZXNwb25zZSk7XG4gICAgfVxuXG4gICAgZGVsZXRlQ2FyZChjYXJkSWQpIHtcbiAgICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH1gLCB7XG4gICAgICAgIG1ldGhvZDogJ0RFTEVURScsXG4gICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnNcbiAgICAgIH0pXG4gICAgICAudGhlbih0aGlzLl9nZXRSZXNwb25zZSk7XG4gICAgfVxuICBcblxufSIsImltcG9ydCB7IFBvcHVwIH0gZnJvbSBcIi4vUG9wdXAuanNcIjtcblxuZXhwb3J0IGNsYXNzIFBvcHVwV2l0aEFwcGx5IGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XG4gICAgdGhpcy5fZm9ybSA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fZm9ybScpO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fc2F2ZS1idG4nKTtcbiAgfVxuXG4gIGhhbmRsZURlbGV0ZUNvbmZpcm0oeyBoYW5kbGVQcm9maWxlRm9ybVN1Ym1pdCB9KSB7XG4gICAgdGhpcy5faGFuZGxlUHJvZmlsZUZvcm1TdWJtaXQgPSBoYW5kbGVQcm9maWxlRm9ybVN1Ym1pdDtcbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzID0gKCkgPT4ge1xuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgdGhpcy5fZm9ybS5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCAoZSkgPT4ge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgdGhpcy5faGFuZGxlUHJvZmlsZUZvcm1TdWJtaXQoKTtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9KTtcbiAgfVxufVxuIiwiaW1wb3J0IHsgQ2FyZCwgY29uZmlnfSBmcm9tIFwiLi4vc2NyaXB0cy9DYXJkLmpzXCI7XG5pbXBvcnQgeyBGb3JtVmFsaWRhdG9yLCBmb3JtU2V0dGluZyB9IGZyb20gXCIuLi9zY3JpcHRzL0Zvcm1WYWxpZGF0b3IuanNcIjtcbmltcG9ydCB7IFNlY3Rpb24gfSBmcm9tICcuLi9zY3JpcHRzL1NlY3Rpb24uanMnO1xuaW1wb3J0IHsgUG9wdXAgfSBmcm9tICcuLi9zY3JpcHRzL1BvcHVwLmpzJztcbmltcG9ydCB7IFBvcHVwV2l0aEltYWdlIH0gZnJvbSAnLi4vc2NyaXB0cy9Qb3B1cFdpdGhJbWFnZS5qcyc7XG5pbXBvcnQgeyBQb3B1cFdpdGhGb3JtIH0gZnJvbSAnLi4vc2NyaXB0cy9Qb3B1cFdpdGhGb3JtLmpzJztcbmltcG9ydCB7IFVzZXJJbmZvIH0gZnJvbSAnLi4vc2NyaXB0cy9Vc2VySW5mby5qcyc7XG5pbXBvcnQgeyBBcGkgfSBmcm9tICcuLi9zY3JpcHRzL0FwaS5qcyc7XG5pbXBvcnQgJy4uL3BhZ2VzL2luZGV4LmNzcyc7XG5pbXBvcnQgeyBQb3B1cFdpdGhBcHBseSB9IGZyb20gXCIuLi9zY3JpcHRzL1BvcHVwV2l0aEFwcGx5LmpzXCI7XG5cblxuY29uc3Qgb3BlblByb2ZpbGVCdXR0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2VkaXQtYnV0dG9uJyk7IC8vINCa0L3QvtC/0LrQuCDQtNC70Y8g0L/QvtC60LDQt9CwINC+0LrQvdCwXG5jb25zdCBpbnB1dE5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjaW5wdXQtbmFtZScpO1xuY29uc3QgaW5wdXRJbmZvID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2lucHV0LWluZm8nKTtcbi8vNSDRgdC/0YDQuNC90YJcbmNvbnN0IG9wZW5DYXJkQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2FkZC1idXR0b24nKVxuXG5jb25zdCBiaWdJbWFnZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fYmlnLWltYWdlJyk7XG5jb25zdCBiaWdUaXRsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fYmlnLXRpdGxlJyk7XG5jb25zdCBjYXJkSW1hZ2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfaW1hZ2UnKVxuXG5cbi8vINCh0LXQu9C10LrRgtC+0YDRiyDQv9C+0L/QsNC/0L7QsjpcbmNvbnN0IHByb2ZpbGVQb3B1cFNlbGVjdG9yID0gJy5wb3B1cF9wcm9maWxlJztcbmNvbnN0IGFkZENhcmRQb3B1cFNlbGVjdG9yID0gJy5wb3B1cF9jYXJkJztcbmNvbnN0IGltYWdlUG9wdXBTZWxlY3RvciA9ICcucG9wdXBfaW1hZ2UnO1xuY29uc3QgYXZhdGFyUG9wdXBTZWxlY3RvciA9ICcucG9wdXBfYXZhdGFyJztcblxuXG5jb25zdCBmb3JtRWRpdFByb2ZpbGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19mb3JtLXByb2ZpbGVcIik7XG5jb25zdCBmb3JtQWRkQ2FyZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2Zvcm0tY2FyZFwiKTtcbmNvbnN0IGZvcm1BdmF0YXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2Zvcm0tYXZhdGFyJylcblxuXG4vLyDQodC10LvQtdC60YLQvtGAINC00LvRjyDQstGL0LHQvtGA0LAg0LrQvtC90YLQtdC50L3QtdGA0LAg0LrQsNGA0YLQvtGH0LXQujpcbmNvbnN0IHNlbGVjdG9yID0gJy5lbGVtZW50c19fbGlzdCc7XG5cbmNvbnN0IGJ0bkZvcm1TZWxlY3RvciA9ICcucG9wdXBfX3NhdmUtYnRuJztcbmNvbnN0IGJ0bkxvYWRpbmdUZXh0ID0gJ9Ch0L7RhdGA0LDQvdC10L3QuNC1Li4uJztcblxuLy85XG5jb25zdCBhcGlPcHRpb25zID0ge1xuICBiYXNlVXJsOiAnaHR0cHM6Ly9tZXN0by5ub21vcmVwYXJ0aWVzLmNvL3YxL2NvaG9ydC02MicsXG4gIGhlYWRlcnM6IHtcbiAgICBhdXRob3JpemF0aW9uOiAnYmM0NDBiY2UtODhkMi00MGRlLTgxM2YtOTE4NmE1MjExYTcxJyxcbiAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nXG4gIH1cbn07XG5cblxuY29uc3QgdmFsaWRhdG9yUHJvZmlsZUZvcm0gPSBuZXcgRm9ybVZhbGlkYXRvcihmb3JtU2V0dGluZywgZm9ybUVkaXRQcm9maWxlKTtcbnZhbGlkYXRvclByb2ZpbGVGb3JtLmVuYWJsZVZhbGlkYXRpb24oKVxuY29uc3QgdmFsaWRhdG9yQ2FyZEZvcm0gPSBuZXcgRm9ybVZhbGlkYXRvcihmb3JtU2V0dGluZywgZm9ybUFkZENhcmQpO1xudmFsaWRhdG9yQ2FyZEZvcm0uZW5hYmxlVmFsaWRhdGlvbigpXG5jb25zdCBhdmF0YXJGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoZm9ybVNldHRpbmcsIGZvcm1BdmF0YXIpXG5hdmF0YXJGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKVxuLy8g0Y3QutC30LXQvNC/0LvRj9GAINC60LvQsNGB0YHQsCBBcGk6XG5jb25zdCBhcGkgPSBuZXcgQXBpKGFwaU9wdGlvbnMpO1xuXG4vLyAgdXNlcklkXG5sZXQgdXNlcklkO1xuXG5cblxuY29uc3QgZGF0YSA9IHtcbiAgcHJvZmlsZU5hbWVTZWxlY3RvcjogJy5wcm9maWxlX19uYW1lJyxcbiAgcHJvZmlsZUluZm9TZWxlY3RvcjogJy5wcm9maWxlX190ZXh0JyxcbiAgYXZhdGFyU2VsZWN0b3I6ICcucHJvZmlsZV9fYXZhdGFyJ1xufVxuXG5jb25zdCB1c2VyRGF0YSA9IG5ldyBVc2VySW5mbyhkYXRhKTtcbmNvbnN0IGltYWdlUG9wdXAgPSBuZXcgUG9wdXBXaXRoSW1hZ2UoaW1hZ2VQb3B1cFNlbGVjdG9yKTtcbmNvbnN0IHBvcHVwV2l0aEFwcGx5ID0gbmV3IFBvcHVwV2l0aEFwcGx5KCcucG9wdXBfZGVsZXRlJyk7XG5cblxuXG5jb25zdCBzZWN0aW9uID0gbmV3IFNlY3Rpb24oe1xuICByZW5kZXJlcjogKGl0ZW0pID0+IHtcbiAgICBjb25zdCBjYXJkRWxlbWVudCA9IGNyZWF0ZUNhcmQoaXRlbSkuY3JlYXRlTmV3Q2FyZCgpO1xuICAgIHNlY3Rpb24uYWRkSXRlbShjYXJkRWxlbWVudCk7XG4gIH0sXG59LCBzZWxlY3RvcilcblxuXG5cbi8v0LTQsNC90L3Ri9C1INGBINGB0LXRgNCy0LXRgNCwIFxuYXBpLmdldFVzZXJEYXRhKClcbiAgLnRoZW4oKHVzZXIpID0+IHtcbiAgICB1c2VyRGF0YS5zZXRVc2VySW5mbyh7IG5hbWU6IHVzZXIubmFtZSwgYWJvdXQ6IHVzZXIuYWJvdXQgfSk7XG4gICAgdXNlckRhdGEuc2V0VXNlckF2YXRhcih7IGxpbms6IHVzZXIuYXZhdGFyIH0pO1xuICAgIHVzZXJJZCA9IHVzZXIuX2lkO1xuICAgIGFwaS5nZXRJbml0aWFsQ2FyZHMoKVxuICAgICAgLnRoZW4oKGNhcmRzKSA9PiB7XG4gICAgICAgIHNlY3Rpb24ucmVuZGVySXRlbXMoY2FyZHMpO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgICB9KTtcbiAgfSlcbiAgLmNhdGNoKChlcnIpID0+IGFsZXJ0KGVycikpO1xuXG5jb25zdCBwcm9maWxlUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShwcm9maWxlUG9wdXBTZWxlY3RvcixcbiAgKHVzZXJJbmZvLCBidG5Gb3JtKSA9PiB7XG4gICAgY29uc3QgYnRuRm9ybUluaXRpYWxUZXh0ID0gYnRuRm9ybS50ZXh0Q29udGVudDtcbiAgICBzaG93TG9hZGluZ1RleHQoYnRuRm9ybSwgYnRuTG9hZGluZ1RleHQpO1xuICAgIGFwaS5lZGl0VXNlckRhdGEodXNlckluZm8pXG4gICAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICAgIHVzZXJEYXRhLnNldFVzZXJJbmZvKHJlcyk7XG4gICAgICB9KVxuXG4gICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgIHByb2ZpbGVQb3B1cC5jbG9zZSgpO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiB7YWxlcnQoZXJyKVxuICAgICAgICB1c2VyRGF0YS5zZXRVc2VySW5mbyh1c2VySW5mbylcbiAgICAgIH0pXG4gICAgXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgc2hvd0xvYWRpbmdUZXh0KGJ0bkZvcm0sIGJ0bkZvcm1Jbml0aWFsVGV4dClcbiAgICB9KVxuICB9LCBidG5Gb3JtU2VsZWN0b3IpOy8vIHByb2ZpbGVTdWJtaXRIYW5kbGVyKTtcblxuXG4vL9Ch0LvRg9GI0LDRgtC10LvRjCDQvdCwINC+0YLQutGA0YvRgtC40LUg0LTQu9GPINC/0YDQvtGE0LjQu9GPXG5vcGVuUHJvZmlsZUJ1dHR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gIGNvbnN0IGluZm9PYmplY3QgPSB1c2VyRGF0YS5nZXRVc2VySW5mbygpO1xuICBpbnB1dE5hbWUudmFsdWUgPSBpbmZvT2JqZWN0Lm5hbWU7XG4gIGlucHV0SW5mby52YWx1ZSA9IGluZm9PYmplY3QuaW5mbztcbiAgdmFsaWRhdG9yUHJvZmlsZUZvcm0ucmVzZXRWYWxpZGF0aW9uKCk7XG4gIHByb2ZpbGVQb3B1cC5vcGVuKClcbn0pO1xuXG4vLyDRgdCw0LHQvNC40YLQsCDQtNC70Y8g0LrQsNGA0YLQvtGH0LXQulxuY29uc3QgYWRkQ2FyZFBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXG4gIGFkZENhcmRQb3B1cFNlbGVjdG9yLFxuICAoZGF0YSwgYnRuRm9ybSkgPT4ge1xuICAgIGNvbnN0IGJ0bkZvcm1Jbml0aWFsVGV4dCA9IGJ0bkZvcm0udGV4dENvbnRlbnQ7XG4gICAgc2hvd0xvYWRpbmdUZXh0KGJ0bkZvcm0sIGJ0bkxvYWRpbmdUZXh0KTtcbiAgICBhcGkuY3JlYXRlQ2FyZChkYXRhKVxuICAgICAgLnRoZW4oKGl0ZW0pID0+IHtcbiAgICAgICAgY3JlYXRlQ2FyZChpdGVtKTtcbiAgICAgICAgc2VjdGlvbi5hZGRJdGVtKGNyZWF0ZUNhcmQoaXRlbSkuY3JlYXRlTmV3Q2FyZCgpKTtcbiAgICAgICAgYWRkQ2FyZFBvcHVwLmNsb3NlKClcbiAgICAgIH0pXG4gICAgXG4gICAgLmNhdGNoKChlcnIpID0+IGFsZXJ0KGVycikpXG4gIFxuICAuZmluYWxseSgoKSA9PiB7XG4gICAgc2hvd0xvYWRpbmdUZXh0KGJ0bkZvcm0sIGJ0bkZvcm1Jbml0aWFsVGV4dClcbiAgfSlcbn0sIGJ0bkZvcm1TZWxlY3Rvcik7XG5cbi8vINGB0LvRg9GI0LDRgtC10LvRjCDQvdCwINC+0YLQutGA0YvRgtC40LUg0L/QvtC/0LDQv9CwIGNhcmRcbm9wZW5DYXJkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICBhZGRDYXJkUG9wdXAub3BlbigpO1xuICB2YWxpZGF0b3JDYXJkRm9ybS5yZXNldFZhbGlkYXRpb24oKTtcbn0pO1xuXG5cblxuXG5mdW5jdGlvbiBjcmVhdGVDYXJkKGNhcmREYXRhKSB7XG4gIGNvbnN0IGNhcmQgPSBuZXcgQ2FyZChjYXJkRGF0YSwgY29uZmlnLCBoYW5kbGVDYXJkQ2xpY2ssIHVzZXJJZCwge1xuICAgIGhhbmRsZUxpa2VDYXJkOiAoZGF0YSkgPT4ge1xuICAgICAgaWYgKGNhcmQuaXNMaWtlZCkge1xuICAgICAgICBhcGkuZGVsZXRlTGlrZShkYXRhLl9pZClcbiAgICAgICAgICAudGhlbigoZGF0YSkgPT4ge1xuICAgICAgICAgICAgY2FyZC5pc0xpa2VkID0gZmFsc2U7XG4gICAgICAgICAgICBjYXJkLmdldExpa2VzTnVtYmVyKGRhdGEubGlrZXMubGVuZ3RoKTtcbiAgICAgICAgICAgIGNhcmQubGlrZUNhcmQoKTtcbiAgICAgICAgICB9KVxuICAgICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgZWxzZSB7XG4gICAgICAgIGFwaS5hZGRMaWtlKGRhdGEpXG4gICAgICAgICAgLnRoZW4oKGRhdGEpID0+IHtcbiAgICAgICAgICAgIGNhcmQuaXNMaWtlZCA9IHRydWU7XG4gICAgICAgICAgICBjYXJkLmdldExpa2VzTnVtYmVyKGRhdGEubGlrZXMubGVuZ3RoKTtcbiAgICAgICAgICAgIGNhcmQubGlrZUNhcmQoKTtcbiAgICAgICAgICB9KVxuICAgICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cbiAgfSxcbiAge1xuICAgIGhhbmRsZURlbGV0ZUNhcmQ6IChkYXRhLCBjYXJkKSA9PiB7XG4gICAgICBwb3B1cFdpdGhBcHBseS5vcGVuKCk7XG4gICAgICBwb3B1cFdpdGhBcHBseS5oYW5kbGVEZWxldGVDb25maXJtKHtcbiAgICAgICAgaGFuZGxlUHJvZmlsZUZvcm1TdWJtaXQ6ICgpID0+IHtcbiAgICAgICAgICBhcGkuZGVsZXRlQ2FyZChkYXRhLl9pZClcbiAgICAgICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgICAgICBjYXJkLmRlbGV0ZUNhcmQoKTtcbiAgICAgICAgICB9KVxuICAgICAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgICAgIHBvcHVwV2l0aEFwcGx5LmNsb3NlKCk7XG4gICAgICAgICAgfSlcbiAgICAgICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICB9LFxuICApO1xuICByZXR1cm4gY2FyZFxufVxuXG5jb25zdCBhdmF0YXJQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKCcucG9wdXBfYXZhdGFyJywgXG4gICAoaW5wdXREYXRhLCBidG5Gb3JtKSA9PiB7XG4gICAgY29uc3QgYnRuRm9ybUluaXRpYWxUZXh0ID0gYnRuRm9ybS50ZXh0Q29udGVudDtcbiAgICBzaG93TG9hZGluZ1RleHQoYnRuRm9ybSwgYnRuTG9hZGluZ1RleHQpO1xuICAgIGFwaS5lZGl0VXNlckF2YXRhcihpbnB1dERhdGEubGluaylcbiAgICAgIC50aGVuKCh1c2VyKSA9PiB7XG4gICAgICAgIHVzZXJEYXRhLnNldFVzZXJBdmF0YXIoeyBsaW5rOiB1c2VyLmF2YXRhciB9KTtcbiAgICAgICAgYXZhdGFyUG9wdXAuY2xvc2UoKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgICAgfSlcbiAgICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgICAgc2hvd0xvYWRpbmdUZXh0KGJ0bkZvcm0sIGJ0bkZvcm1Jbml0aWFsVGV4dClcbiAgICAgIH0pXG4gICAgfSwgYnRuRm9ybVNlbGVjdG9yXG4gIClcblxuLy8g0J7RgtC60YDRi9Cy0LDQtdC8INGE0L7RgNC80YMg0LDQstCw0YLQsNGA0LBcbmNvbnN0IGF2YXRhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19hdmF0YXItYnV0dG9uJyk7XG5hdmF0YXIuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gIGF2YXRhckZvcm1WYWxpZGF0b3IucmVzZXRWYWxpZGF0aW9uKCk7XG4gIGF2YXRhclBvcHVwLm9wZW4oKTtcbn0pO1xuXG5mdW5jdGlvbiBzaG93TG9hZGluZ1RleHQoYnRuRm9ybSwgdGV4dCkge1xuICBidG5Gb3JtLnRleHRDb250ZW50ID0gdGV4dDtcbn1cblxuZnVuY3Rpb24gaGFuZGxlQ2FyZENsaWNrKG5hbWUsIGxpbmspIHtcbiAgaW1hZ2VQb3B1cC5vcGVuKG5hbWUsIGxpbmspO1xufVxuXG5cbi8vINC+0LHRgNCw0LHQvtGC0YfQuNC60Lgg0YHQvtCx0YvRgtC40Lkg0L/QvtC/0LDQv9C+0LJcbnByb2ZpbGVQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xuYWRkQ2FyZFBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5pbWFnZVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5hdmF0YXJQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xucG9wdXBXaXRoQXBwbHkuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuXG5cblxuXG5cbiJdLCJuYW1lcyI6WyJjb25maWciLCJzZWxlY3Rvckxpc3QiLCJzZWxlY3RvclRlbXBsYXRlIiwiY2FyZEltZ1NlbGVjdG9yIiwiY2FyZFRpdGxlU2VsZWN0b3IiLCJjYXJkRGVsZXRlQnRuU2VsZWN0b3IiLCJ0b2dnbGVMaWtlU2VsZWN0b3IiLCJhY3RpdmVMaWtlQnRuQ2xhc3MiLCJjb3VudExpa2VzIiwiQ2FyZCIsImNhcmREYXRhIiwiaGFuZGxlQ2FyZENsaWNrIiwidXNlcklkIiwiX3JlZiIsIl9yZWYyIiwiX3RoaXMiLCJoYW5kbGVMaWtlQ2FyZCIsImhhbmRsZURlbGV0ZUNhcmQiLCJfY2xhc3NDYWxsQ2hlY2siLCJfZGVmaW5lUHJvcGVydHkiLCJfaGFuZGxlRGVsZXRlQ2FyZCIsIl9jYXJkRGF0YSIsIl9saWtlcyIsInNvbWUiLCJsaWtlciIsIl9pZCIsIl91c2VySWQiLCJfbGlrZUJ1dHRvbiIsImNsYXNzTGlzdCIsImFkZCIsImlzTGlrZWQiLCJyZW1vdmUiLCJsaWtlc051bWJlciIsIl9saWtlTnVtYmVyIiwiaW5uZXJIVE1MIiwidG9nZ2xlIiwiX2NhcmRPd25lciIsIl9kZWxldGVCdXR0b24iLCJ0aGlzIiwiX25hbWUiLCJuYW1lIiwiX2xpbmsiLCJsaW5rIiwiX2NvbmZpZyIsIl9oYW5kbGVDYXJkQ2xpY2siLCJfaGFuZGxlTGlrZUNhcmQiLCJsaWtlcyIsIm93bmVyIiwia2V5IiwidmFsdWUiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiX2VsZW1lbnQiLCJlbGVtZW50c0xpa2UiLCJfdGhpczIiLCJkZWxldGVDYXJkIiwiYWRkRXZlbnRMaXN0ZW5lciIsIl9kZWxldGVDYXJkRm9yU3VyZSIsIl9jYXJkSW1hZ2UiLCJfZ2V0VGVtcGxhdGUiLCJzcmMiLCJhbHQiLCJjb25jYXQiLCJ0ZXh0Q29udGVudCIsImxlbmd0aCIsIl9zZXREZWxldGVCdXR0b24iLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJfZ2V0Q2FyZExpa2UiLCJnZXRMaWtlc051bWJlciIsImZvcm1TZXR0aW5nIiwiZm9ybVNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJGb3JtVmFsaWRhdG9yIiwiZm9ybUVsZW1lbnQiLCJfZm9ybVNldHRpbmciLCJfZm9ybUVsZW1lbnQiLCJfaW5wdXRMaXN0IiwiQXJyYXkiLCJmcm9tIiwicXVlcnlTZWxlY3RvckFsbCIsIl9zdWJtaXRCdXR0b24iLCJpbnB1dEVsZW1lbnQiLCJlcnJvck1lc3NhZ2UiLCJlcnJvckVsZW1lbnQiLCJpZCIsInZhbGlkaXR5IiwidmFsaWQiLCJfaGlkZUlucHV0RXJyb3IiLCJfc2hvd0lucHV0RXJyb3IiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsIl90b2dnbGVCdXR0b25TdGF0ZSIsImZvckVhY2giLCJfaGFzSW52YWxpZElucHV0IiwiZGlzYWJsZWQiLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwiZXZ0IiwicHJldmVudERlZmF1bHQiLCJTZWN0aW9uIiwic2VsZWN0b3IiLCJpdGVtcyIsInJlbmRlcmVyIiwiX3JlbmRlckl0ZW1zIiwiX3JlbmRlcmVyIiwiX2NvbnRhaW5lciIsIml0ZW0iLCJwcmVwZW5kIiwiUG9wdXAiLCJwb3B1cFNlbGVjdG9yIiwiX3BvcHVwIiwiX2hhbmRsZUVzY0Nsb3NlIiwiYmluZCIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJjbG9zZSIsInRhcmdldCIsImNvbnRhaW5zIiwiUG9wdXBXaXRoSW1hZ2UiLCJfUG9wdXAiLCJfaW5oZXJpdHMiLCJfc3VwZXIiLCJjYWxsIiwiX3BvcHVwQmlnSW1hZ2UiLCJfcG9wdXBUaXRsZSIsIl9nZXQiLCJfZ2V0UHJvdG90eXBlT2YiLCJwcm90b3R5cGUiLCJQb3B1cFdpdGhGb3JtIiwiaGFuZGxlUHJvZmlsZUZvcm1TdWJtaXQiLCJidG5Gb3JtU2VsZWN0b3IiLCJfdGhpc1N1cGVyIiwiX2Fzc2VydFRoaXNJbml0aWFsaXplZCIsImlucHV0VmFsdWVzIiwiaW5wdXRJdGVtIiwiX2Zvcm0iLCJlIiwiX2hhbmRsZVByb2ZpbGVGb3JtU3VibWl0IiwiX2dldElucHV0VmFsdWVzIiwiX2J0bkZvcm0iLCJfaW5wdXRGb3JtVmFsdWVzIiwicmVzZXQiLCJVc2VySW5mbyIsInByb2ZpbGVOYW1lU2VsZWN0b3IiLCJwcm9maWxlSW5mb1NlbGVjdG9yIiwiYXZhdGFyU2VsZWN0b3IiLCJfaW5mbyIsIl91c2VyQXZhdGFyIiwiaW5mbyIsImFib3V0IiwiQXBpIiwib3B0aW9ucyIsIl9iYXNlVXJsIiwiYmFzZVVybCIsIl9oZWFkZXJzIiwiaGVhZGVycyIsInJlcyIsIm9rIiwianNvbiIsIlByb21pc2UiLCJyZWplY3QiLCJzdGF0dXMiLCJmZXRjaCIsIm1ldGhvZCIsInRoZW4iLCJfZ2V0UmVzcG9uc2UiLCJ1c2VySW5mbyIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiZGF0YSIsImNhcmRJZCIsImF2YXRhclVybCIsImF2YXRhciIsIlBvcHVwV2l0aEFwcGx5Iiwib3BlblByb2ZpbGVCdXR0dG9uIiwiaW5wdXROYW1lIiwiaW5wdXRJbmZvIiwib3BlbkNhcmRCdXR0b24iLCJmb3JtRWRpdFByb2ZpbGUiLCJmb3JtQWRkQ2FyZCIsImZvcm1BdmF0YXIiLCJidG5Mb2FkaW5nVGV4dCIsInZhbGlkYXRvclByb2ZpbGVGb3JtIiwiZW5hYmxlVmFsaWRhdGlvbiIsInZhbGlkYXRvckNhcmRGb3JtIiwiYXZhdGFyRm9ybVZhbGlkYXRvciIsImFwaSIsImF1dGhvcml6YXRpb24iLCJ1c2VyRGF0YSIsImltYWdlUG9wdXAiLCJwb3B1cFdpdGhBcHBseSIsInNlY3Rpb24iLCJjYXJkRWxlbWVudCIsImNyZWF0ZUNhcmQiLCJjcmVhdGVOZXdDYXJkIiwiYWRkSXRlbSIsImdldFVzZXJEYXRhIiwidXNlciIsInNldFVzZXJJbmZvIiwic2V0VXNlckF2YXRhciIsImdldEluaXRpYWxDYXJkcyIsImNhcmRzIiwicmVuZGVySXRlbXMiLCJjYXRjaCIsImVyciIsImNvbnNvbGUiLCJsb2ciLCJhbGVydCIsInByb2ZpbGVQb3B1cCIsImJ0bkZvcm0iLCJidG5Gb3JtSW5pdGlhbFRleHQiLCJzaG93TG9hZGluZ1RleHQiLCJlZGl0VXNlckRhdGEiLCJmaW5hbGx5IiwiaW5mb09iamVjdCIsImdldFVzZXJJbmZvIiwicmVzZXRWYWxpZGF0aW9uIiwib3BlbiIsImFkZENhcmRQb3B1cCIsImNhcmQiLCJkZWxldGVMaWtlIiwibGlrZUNhcmQiLCJhZGRMaWtlIiwiaGFuZGxlRGVsZXRlQ29uZmlybSIsImF2YXRhclBvcHVwIiwiaW5wdXREYXRhIiwiZWRpdFVzZXJBdmF0YXIiLCJ0ZXh0Iiwic2V0RXZlbnRMaXN0ZW5lcnMiXSwic291cmNlUm9vdCI6IiJ9